<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Keskonmanj">
<title>Keskonmanj</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Crimson+Pro:ital,wght@0,300;0,400;0,600;1,300;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
:root{
  --cream:#F5EFE0;--warm-white:#FDFAF4;--terracotta:#C4602A;
  --terracotta-light:#E8865A;--dark:#1A1208;--brown:#5C3D1E;
  --wood:#8B5E3C;--wood-light:#C49A6C;--sage:#7A8C6E;--gold:#D4A843;
  --border:#D4C4A0;--rust:#A0522D;
  --safe-top:env(safe-area-inset-top,0px);
  --safe-bottom:env(safe-area-inset-bottom,0px);
  --safe-left:env(safe-area-inset-left,0px);
  --safe-right:env(safe-area-inset-right,0px);
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html{font-size:16px;}
body{background:var(--cream);color:var(--dark);font-family:'DM Sans',sans-serif;min-height:100vh;-webkit-font-smoothing:antialiased;overflow-x:hidden;}

/* HEADER */
header{background:linear-gradient(135deg,#3D2B1F 0%,#5C3D1E 40%,#4A3728 70%,#6B4C35 100%);color:var(--cream);padding:calc(1.2rem + var(--safe-top)) 1.2rem 1.2rem;display:flex;align-items:center;justify-content:space-between;border-bottom:3px solid var(--terracotta);position:sticky;top:0;z-index:100;overflow:hidden;}
header::after{content:'';position:absolute;bottom:0;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--terracotta),var(--gold),var(--terracotta));}
.logo-wrap{display:flex;align-items:center;gap:.9rem;position:relative;z-index:1;}
.logo-icon{width:44px;height:44px;flex-shrink:0;filter:drop-shadow(0 2px 6px rgba(0,0,0,.4));}
.logo-text-wrap{display:flex;flex-direction:column;}
.logo{font-family:'Bebas Neue',sans-serif;font-size:2rem;letter-spacing:3px;color:var(--cream);line-height:1;text-shadow:2px 2px 0 rgba(0,0,0,.3);}
.logo span{color:var(--terracotta-light);}
.subtitle{font-family:'Crimson Pro',serif;font-size:.75rem;color:var(--wood-light);letter-spacing:1.5px;font-style:italic;margin-top:1px;}
.save-badge{background:var(--sage);color:white;font-size:.7rem;padding:.3rem .75rem;border-radius:999px;display:none;align-items:center;gap:.3rem;}
.save-badge.visible{display:flex;}

/* APP */
.app{max-width:680px;margin:0 auto;padding:1.5rem max(1rem,var(--safe-left)) calc(2rem + var(--safe-bottom)) max(1rem,var(--safe-right));}
.section-title{font-family:'Crimson Pro',serif;font-size:1.4rem;font-weight:600;color:var(--brown);margin-bottom:.3rem;}
.section-sub{font-size:.82rem;color:var(--sage);margin-bottom:1.2rem;}

/* SAVED BANNER */
.saved-banner{background:var(--brown);color:var(--cream);border-radius:12px;padding:.9rem 1.2rem;margin-bottom:1.5rem;display:none;align-items:center;justify-content:space-between;gap:1rem;}
.saved-banner.visible{display:flex;}
.saved-banner-text{font-size:.85rem;}
.saved-banner-text strong{font-family:'Crimson Pro',serif;font-size:1rem;display:block;margin-bottom:2px;}
.restore-btn{padding:.45rem 1rem;background:var(--terracotta);color:white;border:none;border-radius:8px;cursor:pointer;font-family:'DM Sans',sans-serif;font-size:.82rem;white-space:nowrap;min-height:44px;touch-action:manipulation;}

/* FOYER */
.foyer-section{background:var(--warm-white);border:1.5px solid var(--border);border-radius:14px;padding:1.4rem;margin-bottom:1.5rem;}
.foyer-grid{display:grid;grid-template-columns:1fr;gap:1.2rem;margin-top:.8rem;}
.foyer-field label{display:block;font-size:.75rem;font-weight:500;letter-spacing:1.5px;text-transform:uppercase;color:#374151;margin-bottom:.45rem;}
.foyer-field select{width:100%;padding:.75rem 1rem;border:1.5px solid var(--border);border-radius:8px;font-family:'DM Sans',sans-serif;font-size:1rem;color:var(--dark);background:white;-webkit-appearance:none;outline:none;min-height:44px;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%235C3D1E' stroke-width='2' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 1rem center;padding-right:2.5rem;touch-action:manipulation;}
.foyer-field select:focus{border-color:var(--terracotta);}
.allergies-grid{display:flex;flex-wrap:wrap;gap:.4rem;margin-top:.5rem;}
.allergy-btn{padding:.45rem .8rem;border:1.5px solid var(--border);border-radius:999px;background:white;font-family:'DM Sans',sans-serif;font-size:.8rem;color:var(--brown);cursor:pointer;-webkit-appearance:none;min-height:44px;transition:background .15s,border-color .15s,color .15s;user-select:none;-webkit-user-select:none;touch-action:manipulation;}
.allergy-btn.active{background:var(--rust);border-color:var(--rust);color:white;}

/* THEMES */
.themes-grid{display:flex;flex-wrap:wrap;gap:.6rem;margin-bottom:1.5rem;}
.theme-btn{display:flex;align-items:center;gap:.4rem;padding:.55rem 1rem;border:2px solid var(--border);border-radius:999px;background:var(--warm-white);cursor:pointer;font-family:'DM Sans',sans-serif;font-size:.88rem;color:var(--brown);transition:background .15s,border-color .15s,color .15s;-webkit-appearance:none;min-height:40px;user-select:none;-webkit-user-select:none;touch-action:manipulation;}
.theme-btn.selected{background:var(--terracotta);border-color:var(--terracotta);color:white;}
.selected-count{font-size:.82rem;color:var(--sage);margin-bottom:1.2rem;}
.selected-count strong{color:var(--terracotta);}

/* GENERATE */
.generate-btn{display:block;width:100%;padding:1rem;background:linear-gradient(135deg,var(--brown),var(--wood));color:white;border:none;border-radius:12px;font-family:'Bebas Neue',sans-serif;font-size:1.3rem;letter-spacing:2px;cursor:pointer;transition:opacity .2s;margin-bottom:2rem;-webkit-appearance:none;min-height:52px;touch-action:manipulation;}
.generate-btn:disabled{opacity:.4;}

/* LOADING */
.loading{display:none;text-align:center;padding:2.5rem;font-family:'Crimson Pro',serif;font-size:1.1rem;color:var(--brown);font-style:italic;}
.loading.visible{display:block;}
.dots::after{content:'...';animation:dots 1.2s steps(4,end) infinite;}
@keyframes dots{0%,20%{content:'.'}40%{content:'..'}60%,100%{content:'...'}}

/* RESULTS */
#results{display:none;}
#results.visible{display:block;animation:fadeIn .4s ease;}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1}}

/* WEEK */
.week-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1rem;gap:.5rem;}
.legend{display:flex;flex-direction:column;gap:.3rem;font-size:.75rem;}
.legend-item{display:flex;align-items:center;gap:.35rem;color:var(--brown);}
.legend-dot{width:10px;height:10px;border-radius:2px;flex-shrink:0;}
.legend-dot.lunch{background:var(--terracotta-light);}
.legend-dot.dinner{background:var(--sage);}
.days-list{display:flex;flex-direction:column;gap:.75rem;margin-bottom:2rem;}
.day-card{background:var(--warm-white);border:1.5px solid var(--border);border-radius:12px;overflow:hidden;}
.day-name{background:linear-gradient(135deg,var(--wood),var(--wood-light));color:white;padding:.45rem 1rem;font-family:'Bebas Neue',sans-serif;font-size:.9rem;letter-spacing:2px;}
.day-meals{padding:.6rem .75rem;display:grid;grid-template-columns:1fr 1fr;gap:.5rem;}
.meal-item{padding:.6rem .75rem;border-radius:8px;font-size:.82rem;line-height:1.35;cursor:pointer;position:relative;transition:transform .15s;min-height:70px;touch-action:manipulation;}
.meal-item:active{transform:scale(.97);}
.meal-item.lunch{background:#FFF3E8;border-left:3px solid var(--terracotta-light);}
.meal-item.dinner{background:#EEF2EC;border-left:3px solid var(--sage);}
.meal-label{font-size:.62rem;text-transform:uppercase;letter-spacing:1px;color:var(--sage);font-weight:500;margin-bottom:3px;}
.meal-name{color:var(--dark);font-weight:500;font-size:.8rem;}
.meal-theme-tag{display:inline-block;font-size:.6rem;background:var(--cream);color:var(--brown);border-radius:3px;padding:1px 5px;margin-top:3px;}
.meal-item.has-warning::after{content:'âš ï¸';position:absolute;top:4px;right:4px;font-size:.7rem;}

/* MODAL RECETTE */
.modal-overlay{position:fixed;inset:0;background:rgba(26,18,8,.8);z-index:1000;display:flex;align-items:flex-end;justify-content:center;opacity:0;pointer-events:none;transition:opacity .3s;}
.modal-overlay.open{opacity:1;pointer-events:all;}
.modal{background:var(--warm-white);border-radius:20px 20px 0 0;width:100%;max-height:90vh;overflow-y:auto;transform:translateY(100%);transition:transform .35s cubic-bezier(.34,1.1,.64,1);padding-bottom:calc(1.5rem + var(--safe-bottom));-webkit-overflow-scrolling:touch;}
.modal-overlay.open .modal{transform:translateY(0);}
.modal-handle{width:40px;height:4px;background:var(--border);border-radius:999px;margin:12px auto 4px;}
.modal-header{background:linear-gradient(135deg,#3D2B1F,#5C3D1E);color:var(--cream);padding:1.4rem 1.5rem 1.2rem;position:sticky;top:0;z-index:2;}
.modal-tag{font-size:.65rem;letter-spacing:2px;text-transform:uppercase;color:var(--wood-light);margin-bottom:.4rem;}
.modal-title{font-family:'Crimson Pro',serif;font-size:1.5rem;font-weight:600;line-height:1.2;}
.modal-meta{display:flex;flex-wrap:wrap;gap:.75rem;margin-top:.6rem;font-size:.78rem;color:var(--wood-light);}
.modal-close{position:absolute;top:1rem;right:1rem;background:rgba(255,255,255,.15);border:none;color:var(--cream);width:36px;height:36px;border-radius:50%;cursor:pointer;font-size:1.1rem;display:flex;align-items:center;justify-content:center;touch-action:manipulation;}
.modal-body{padding:1.4rem 1.5rem;}
.modal-note{background:#FFF3E8;border:1.5px solid var(--terracotta-light);border-radius:8px;padding:.6rem 1rem;font-size:.82rem;color:var(--brown);margin-bottom:1rem;}
.modal-note.warning{background:#FEE2E2;border-color:#F87171;color:#991B1B;}
.recipe-section-title{font-size:.7rem;font-weight:600;letter-spacing:2px;text-transform:uppercase;color:var(--terracotta);margin-bottom:.8rem;padding-bottom:.4rem;border-bottom:1.5px solid var(--border);}
.ingredients-grid{display:grid;grid-template-columns:1fr 1fr;gap:.35rem;margin-bottom:1.5rem;}
@media(max-width:380px){.ingredients-grid{grid-template-columns:1fr;}}
.ingredient-row{display:flex;align-items:center;justify-content:space-between;padding:.4rem .65rem;background:var(--cream);border-radius:6px;font-size:.83rem;gap:.4rem;}
.ingredient-qty{color:var(--sage);font-size:.76rem;white-space:nowrap;}
.steps-list{display:flex;flex-direction:column;gap:.85rem;}
.step{display:flex;gap:.9rem;align-items:flex-start;padding:.85rem;background:var(--cream);border-radius:10px;}
.step-num{min-width:26px;height:26px;background:var(--terracotta);color:white;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.76rem;font-weight:600;flex-shrink:0;}
.step-text{font-size:.86rem;line-height:1.6;padding-top:2px;}
.chef-tip{margin-top:1.3rem;padding:.9rem 1.1rem;background:linear-gradient(135deg,#FFF3E8,#FDFAF4);border:1.5px solid var(--terracotta-light);border-radius:10px;font-size:.84rem;line-height:1.5;}
.chef-tip strong{color:var(--terracotta);display:block;margin-bottom:.3rem;font-size:.73rem;letter-spacing:1px;text-transform:uppercase;}

/* COURSES */
.courses-section{background:var(--warm-white);border:1.5px solid var(--border);border-radius:14px;padding:1.4rem;margin-bottom:1.5rem;}
.courses-title{font-family:'Crimson Pro',serif;font-size:1.3rem;font-weight:600;color:var(--brown);margin-bottom:1.2rem;}
.courses-grid{display:grid;grid-template-columns:1fr;gap:1.2rem;}
@media(min-width:500px){.courses-grid{grid-template-columns:1fr 1fr;}}
.course-category{background:var(--cream);border-radius:10px;padding:.9rem;}
.cat-title{font-size:.72rem;font-weight:600;letter-spacing:1.5px;text-transform:uppercase;color:var(--terracotta);margin-bottom:.65rem;padding-bottom:.4rem;border-bottom:1.5px solid var(--border);}
.course-item{display:flex;align-items:center;justify-content:space-between;padding:.32rem 0;font-size:.84rem;border-bottom:1px dotted var(--border);gap:.5rem;}
.course-item:last-child{border-bottom:none;}
.course-name{flex:1;color:var(--dark);}
.course-qty{font-size:.74rem;color:var(--sage);white-space:nowrap;}

/* ACTION BAR */
.action-bar{display:grid;grid-template-columns:1fr 1fr;gap:.6rem;margin-bottom:1.4rem;}
.action-btn{padding:.75rem .8rem;border-radius:10px;border:2px solid var(--border);background:white;font-family:'DM Sans',sans-serif;font-size:.85rem;cursor:pointer;color:var(--brown);transition:opacity .15s;display:flex;align-items:center;justify-content:center;gap:.35rem;min-height:44px;-webkit-appearance:none;touch-action:manipulation;}
.action-btn.primary{background:var(--sage);border-color:var(--sage);color:white;}
.action-btn.share{background:linear-gradient(135deg,#25D366,#128C7E);color:white;border-color:transparent;}
.action-btn.danger{border-color:#D4A0A0;color:#9B3A3A;}
.action-btn:active{opacity:.7;}

/* SHARE SHEET */
.share-overlay{position:fixed;inset:0;background:rgba(26,18,8,.75);z-index:2000;display:flex;align-items:flex-end;justify-content:center;opacity:0;pointer-events:none;transition:opacity .3s;}
.share-overlay.open{opacity:1;pointer-events:all;}
.share-sheet{background:var(--warm-white);border-radius:20px 20px 0 0;width:100%;max-width:520px;padding:1.2rem 1.2rem calc(1.5rem + var(--safe-bottom));transform:translateY(100%);transition:transform .35s cubic-bezier(.34,1.2,.64,1);}
.share-overlay.open .share-sheet{transform:translateY(0);}
.share-handle{width:40px;height:4px;background:var(--border);border-radius:999px;margin:0 auto 1rem;}
.share-title{font-family:'Crimson Pro',serif;font-size:1.2rem;font-weight:600;color:var(--brown);text-align:center;margin-bottom:.25rem;}
.share-sub{font-size:.78rem;color:var(--sage);text-align:center;margin-bottom:1.2rem;}
.share-options{display:grid;grid-template-columns:repeat(3,1fr);gap:.6rem;margin-bottom:.9rem;}
.share-opt{display:flex;flex-direction:column;align-items:center;gap:.4rem;padding:.9rem .4rem;border:1.5px solid var(--border);border-radius:12px;cursor:pointer;background:white;font-family:'DM Sans',sans-serif;font-size:.76rem;color:var(--brown);text-align:center;transition:opacity .15s;-webkit-appearance:none;min-height:44px;touch-action:manipulation;}
.share-opt:active{opacity:.6;}
.share-opt-icon{font-size:1.6rem;line-height:1;}
.share-copy-row{display:flex;gap:.5rem;margin-top:.6rem;}
.share-copy-input{flex:1;padding:.7rem 1rem;border:1.5px solid var(--border);border-radius:8px;font-size:.8rem;color:var(--dark);background:var(--cream);outline:none;font-family:'DM Sans',sans-serif;}
.share-copy-btn{padding:.7rem .9rem;background:var(--terracotta);color:white;border:none;border-radius:8px;cursor:pointer;font-size:.82rem;font-family:'DM Sans',sans-serif;white-space:nowrap;-webkit-appearance:none;min-height:44px;touch-action:manipulation;}
.share-close-btn{display:block;width:100%;margin-top:.9rem;padding:.75rem;background:var(--cream);border:1.5px solid var(--border);border-radius:10px;cursor:pointer;font-family:'DM Sans',sans-serif;font-size:.88rem;color:var(--brown);-webkit-appearance:none;min-height:44px;touch-action:manipulation;}

/* TOAST */
.toast{position:fixed;bottom:calc(1.5rem + var(--safe-bottom));left:50%;transform:translateX(-50%) translateY(100px);background:var(--dark);color:var(--cream);padding:.75rem 1.4rem;border-radius:999px;font-size:.88rem;z-index:9999;transition:transform .4s cubic-bezier(.34,1.56,.64,1);box-shadow:0 8px 30px rgba(0,0,0,.3);white-space:nowrap;pointer-events:none;}
.toast.show{transform:translateX(-50%) translateY(0);}

/* MISC */
.divider{border:none;border-top:2px solid var(--border);margin:1.5rem 0;}
footer{background:linear-gradient(135deg,#2C1F15,#3D2B1F);color:var(--wood-light);text-align:center;padding:1.2rem 1rem calc(1.2rem + var(--safe-bottom));font-size:.75rem;border-top:3px solid var(--terracotta);margin-top:2rem;}
footer a{color:var(--gold);text-decoration:none;}
.footer-logo{font-family:'Bebas Neue',sans-serif;font-size:1rem;letter-spacing:3px;color:var(--cream);margin-bottom:.3rem;}
@media print{header .save-badge,.themes-grid,.foyer-section,.generate-btn,.action-bar,.modal-overlay,.share-overlay,footer{display:none!important;}#results{display:block!important;}body{background:white;}}
</style>
</head>
<body>

<!-- RECIPE MODAL -->
<div class="modal-overlay" id="recipeOverlay">
  <div class="modal" id="recipeModal">
    <div class="modal-handle"></div>
    <div class="modal-header">
      <div class="modal-tag" id="modalTag"></div>
      <div class="modal-title" id="modalTitle"></div>
      <div class="modal-meta" id="modalMeta"></div>
      <button class="modal-close" id="btnCloseRecipe">âœ•</button>
    </div>
    <div class="modal-body" id="modalBody"></div>
  </div>
</div>

<!-- SHARE SHEET -->
<div class="share-overlay" id="shareOverlay">
  <div class="share-sheet" id="shareSheet">
    <div class="share-handle"></div>
    <div class="share-title">ğŸ“¤ Partager la liste de courses</div>
    <div class="share-sub">Envoie ta liste Ã  toute la famille</div>
    <div class="share-options">
      <button class="share-opt" id="sWhatsapp"><span class="share-opt-icon">ğŸ’¬</span>WhatsApp</button>
      <button class="share-opt" id="sSms"><span class="share-opt-icon">ğŸ“±</span>SMS</button>
      <button class="share-opt" id="sEmail"><span class="share-opt-icon">âœ‰ï¸</span>E-mail</button>
      <button class="share-opt" id="sTelegram"><span class="share-opt-icon">âœˆï¸</span>Telegram</button>
      <button class="share-opt" id="sNative"><span class="share-opt-icon">ğŸ”—</span>Partagerâ€¦</button>
      <button class="share-opt" id="sPrint"><span class="share-opt-icon">ğŸ–¨ï¸</span>Imprimer</button>
    </div>
    <div class="share-copy-row">
      <input class="share-copy-input" id="shareCopyInput" readonly placeholder="Ta listeâ€¦">
      <button class="share-copy-btn" id="sCopy">ğŸ“‹ Copier</button>
    </div>
    <button class="share-close-btn" id="btnCloseShare">âœ• Fermer</button>
  </div>
</div>

<div class="toast" id="toast"></div>

<header>
  <div class="logo-wrap">
    <svg class="logo-icon" viewBox="0 0 58 58" fill="none" xmlns="http://www.w3.org/2000/svg">
      <ellipse cx="27" cy="36" rx="20" ry="14" fill="#8B5E3C" stroke="#C49A6C" stroke-width="1.5"/>
      <ellipse cx="27" cy="36" rx="17" ry="11" fill="#A0522D"/>
      <ellipse cx="22" cy="30" rx="5" ry="3" fill="rgba(255,255,255,0.12)" transform="rotate(-15 22 30)"/>
      <rect x="44" y="33" width="13" height="5" rx="2.5" fill="#6B7280" stroke="#9CA3AF" stroke-width="1"/>
      <circle cx="46" cy="35.5" r="1.2" fill="#374151"/><circle cx="54" cy="35.5" r="1.2" fill="#374151"/>
      <path d="M18 20 Q20 15 18 10" stroke="#C49A6C" stroke-width="1.5" stroke-linecap="round" fill="none" opacity="0.7"/>
      <path d="M26 18 Q28 12 26 7" stroke="#C49A6C" stroke-width="1.5" stroke-linecap="round" fill="none" opacity="0.7"/>
      <path d="M34 20 Q36 15 34 10" stroke="#C49A6C" stroke-width="1.5" stroke-linecap="round" fill="none" opacity="0.7"/>
      <line x1="6" y1="8" x2="6" y2="50" stroke="#9CA3AF" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M6 8 Q10 12 8 28 L6 28Z" fill="#6B7280"/>
      <rect x="4" y="38" width="4" height="10" rx="2" fill="#8B5E3C" stroke="#C49A6C" stroke-width="0.8"/>
    </svg>
    <div class="logo-text-wrap">
      <div class="logo">Keskon<span>manj</span></div>
      <div class="subtitle">Planificateur Â· 7 jours</div>
    </div>
  </div>
  <div class="save-badge" id="saveBadge">ğŸ’¾ SauvegardÃ©</div>
</header>

<div class="app">
  <div class="saved-banner" id="savedBanner">
    <div class="saved-banner-text">
      <strong>ğŸ“… Semaine sauvegardÃ©e !</strong>
      Restaure ta semaine prÃ©cÃ©dente.
    </div>
    <button class="restore-btn" id="btnRestore">ğŸ”„ Restaurer</button>
  </div>

  <div class="foyer-section">
    <div class="section-title">Ton foyer</div>
    <div class="section-sub">Adapte les quantitÃ©s et les recettes</div>
    <div class="foyer-grid">
      <div class="foyer-field">
        <label>ğŸ‘¥ Nombre de personnes</label>
        <select id="nbPersonnes">
          <option value="1">1 personne</option>
          <option value="2" selected>2 personnes</option>
          <option value="3">3 personnes</option>
          <option value="4">4 personnes</option>
          <option value="5">5 personnes</option>
          <option value="6">6 personnes et +</option>
        </select>
      </div>
      <div class="foyer-field">
        <label>âš ï¸ Allergies & intolÃ©rances</label>
        <div class="allergies-grid" id="allergiesGrid"></div>
      </div>
    </div>
  </div>

  <div class="section-title">ThÃ¨mes de la semaine</div>
  <div class="section-sub">SÃ©lectionne 2 Ã  4 thÃ¨mes pour tes 14 repas</div>
  <div class="themes-grid" id="themesGrid"></div>
  <div class="selected-count" id="selectedCount"><strong>0</strong> thÃ¨me(s) â€” choisis entre 2 et 4</div>
  <button class="generate-btn" id="btnGenerate" disabled>ğŸ½ï¸ GÃ©nÃ©rer ma semaine</button>

  <div class="loading" id="loading">Le chef prÃ©pare ta semaine<span class="dots"></span></div>

  <div id="results">
    <div class="week-header">
      <div>
        <div class="section-title">ğŸ“… Ta semaine</div>
        <div class="section-sub" style="margin-bottom:0">Appuie sur un repas pour la recette</div>
      </div>
      <div class="legend">
        <div class="legend-item"><div class="legend-dot lunch"></div>DÃ©jeuner</div>
        <div class="legend-item"><div class="legend-dot dinner"></div>DÃ®ner</div>
      </div>
    </div>
    <div class="days-list" id="daysGrid"></div>
    <hr class="divider">
    <div class="courses-section">
      <div class="courses-title">ğŸ›’ Liste de courses</div>
      <div class="action-bar">
        <button class="action-btn primary" id="btnSave">ğŸ’¾ Sauvegarder</button>
        <button class="action-btn share" id="btnShare">ğŸ“¤ Partager</button>
        <button class="action-btn" id="btnPrint">ğŸ–¨ï¸ Imprimer</button>
        <button class="action-btn danger" id="btnClear">ğŸ—‘ï¸ Effacer</button>
      </div>
      <div class="courses-grid" id="coursesGrid"></div>
    </div>
  </div>
</div>

<footer>
  <div class="footer-logo">Keskonmanj</div>
  <p>Â© 2026 â€” PropriÃ©tÃ© exclusive de <a href="#">fluide.cmpny</a>. Tous droits rÃ©servÃ©s.</p>
</footer>

<script>
// â”€â”€ STORAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var _mem = {};
var Store = {
  get: function(k){ try{ return localStorage.getItem(k); }catch(e){ return _mem[k]||null; } },
  set: function(k,v){ try{ localStorage.setItem(k,v); }catch(e){ _mem[k]=v; } },
  del: function(k){ try{ localStorage.removeItem(k); }catch(e){ delete _mem[k]; } }
};

// â”€â”€ CONSTANTES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var DAYS = ['Lundi','Mardi','Mercredi','Jeudi','Vendredi','Samedi','Dimanche'];

var ALLERGIES = [
  {id:'gluten',label:'ğŸŒ¾ Gluten'},{id:'lactose',label:'ğŸ¥› Lactose'},
  {id:'oeuf',label:'ğŸ¥š Å’ufs'},{id:'poisson',label:'ğŸŸ Poisson'},
  {id:'crustaces',label:'ğŸ¦ CrustacÃ©s'},{id:'noix',label:'ğŸ¥œ Fruits Ã  coques'},
  {id:'soja',label:'ğŸ«˜ Soja'},{id:'porc',label:'ğŸ· Porc'},
  {id:'vegetarien',label:'ğŸ¥¦ VÃ©gÃ©tarien'},{id:'vegan',label:'ğŸŒ± Vegan'}
];

var ALLERGEN_KW = {
  gluten:['pÃ¢tes','spaghetti','penne','tagliatelle','linguine','naan','chapati','bun','toast','croque','quiche','tarte','gnocchi','ramen','nouilles','soba','crÃªpe','galette','pizza','quesadilla','wrap','kebab','bÃ¶rek','panini','pain perdu','boulgour'],
  lactose:['fromage','crÃ¨me','beurre','lait','mozzarella','parmesan','comtÃ©','gruyÃ¨re','cheddar','feta','chÃ¨vre','reblochon','ricotta','burrata','fondue','raclette','tartiflette','gratin','carbonara','quiche','risotto','bÃ©chamel','yaourt','halloumi'],
  oeuf:['Å“uf','omelette','carbonara','quiche','frittata','shakshuka','crÃªpe','pancake','galette','pain perdu'],
  poisson:['saumon','thon','cabillaud','sardine','hareng','dorade','poisson','anchois','morue'],
  crustaces:['crevettes','moules','palourdes','poulpe','saint-jacques','fruits de mer','gambas','bisque'],
  noix:['cacahuÃ¨tes','noix','amandes','noisettes','pistaches','sÃ©same','tahini','arachides','mafÃ©'],
  soja:['soja','tofu','miso','edamame'],
  porc:['lardons','jambon','saucisse','chorizo','porc','hot-dog','cassoulet','andouillette'],
  vegetarien:['poulet','bÅ“uf','veau','agneau','dinde','porc','lardons','jambon','saucisse','chorizo','saumon','thon','cabillaud','crevettes','moules','anchois','sardine','canard','gambas'],
  vegan:['poulet','bÅ“uf','veau','agneau','dinde','porc','lardons','jambon','saucisse','chorizo','saumon','thon','crevettes','moules','anchois','Å“uf','fromage','crÃ¨me','beurre','lait','mozzarella','parmesan','feta','chÃ¨vre','ricotta','yaourt','halloumi','canard']
};

var THEMES = [
  {id:'asiatique',label:'Asiatique',emoji:'ğŸ¥¢'},
  {id:'mediterrane',label:'MÃ©diterranÃ©en',emoji:'ğŸ«’'},
  {id:'gourmand',label:'Gourmand',emoji:'ğŸ§€'},
  {id:'proteine',label:'ProtÃ©inÃ© & sport',emoji:'ğŸ’ª'},
  {id:'fastfood',label:'Fast-food maison',emoji:'ğŸ”'},
  {id:'veggie',label:'VÃ©gÃ©tarien',emoji:'ğŸ¥¦'},
  {id:'francais',label:'Cuisine franÃ§aise',emoji:'ğŸ¥'},
  {id:'rapide',label:'Rapide < 20 min',emoji:'âš¡'},
  {id:'exotique',label:'Exotique & Ã©picÃ©',emoji:'ğŸŒ¶ï¸'},
  {id:'marmite',label:'Plats mijotÃ©s',emoji:'ğŸ«•'},
  {id:'brunch',label:'Brunch & Å“ufs',emoji:'ğŸ³'},
  {id:'mer',label:'Mer & poisson',emoji:'ğŸŸ'},
  {id:'batch',label:'Batch cooking',emoji:'ğŸ“¦'},
  {id:'saison',label:'De saison',emoji:'ğŸŒ¿'},
  {id:'worldstreet',label:'Street food monde',emoji:'ğŸŒ'},
  {id:'salades',label:'Grandes salades',emoji:'ğŸ¥—'},
  {id:'soupe',label:'Soupes & veloutÃ©s',emoji:'ğŸ²'},
  {id:'plancha',label:'Plancha & grill',emoji:'ğŸ”¥'}
];

// â”€â”€ BASE DE REPAS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var MEALS = {
  asiatique:{
    dej:['Bol de ramen poulet-miso','Wok de bÅ“uf aux lÃ©gumes','Poulet teriyaki & riz jasmin','Soupe pho bÅ“uf-herbes','Riz cantonnais Å“uf-jambon','Curry vert thaÃ¯ au tofu','Gyozas poÃªlÃ©s porc-gingembre'],
    din:['Pad thaÃ¯ aux crevettes','Salade de nouilles soba froides','Soupe tom kha champignons','Riz sautÃ© lÃ©gumes-sauce soja','Nems maison sauce nuoc-mÃ¢m','Bibimbap vÃ©gÃ©tarien','Poulet lait de coco-basilic thaÃ¯']
  },
  mediterrane:{
    dej:['Salade grecque feta-olives','Risotto citron-parmesan','Pasta tomates cerises-burrata','Tajine poulet-citron confit','Salade niÃ§oise thon-anchois','Moussaka agneau-aubergines','Bowl falafel-houmous-cruditÃ©s'],
    din:['Soupe minestrone aux lÃ©gumes','Bruschetta tomates-mozzarella','Poivrons farcis riz-agneau','Penne Ã  l\'arrabbiata','Houmous maison & cruditÃ©s pita','Gratin courgettes feta-menthe','Poisson en papillote olives-thym']
  },
  gourmand:{
    dej:['Gratin dauphinois & jambon cru','Quiche lorraine maison','Croque-monsieur faÃ§on chef','Risotto chorizo-Ã©pinards','Tartiflette express reblochon','PÃ¢tes carbonara Ã  la franÃ§aise','Burger maison fromage-oignons caramÃ©lisÃ©s'],
    din:['Soupe Ã  l\'oignon gratinÃ©e','Omelette baveuse champignons-comtÃ©','Toast chÃ¨vre chaud-miel-noix','Gnocchis beurre-sauge-parmesan','PoÃªlÃ©e pommes de terre-lardons','Raclette solo fromage-charcuterie','Gratin chou-fleur bÃ©chamel']
  },
  proteine:{
    dej:['Poulet grillÃ© riz brun-brocolis','Salade CÃ©sar thon-Å“uf dur','Blanc de dinde quinoa-Ã©pinards','Steak hachÃ© maison-patate douce','Bowl avocat-pois chiches-poulet','Saumon grillÃ© lentilles-lÃ©gumes','Omelette jambon-champignons'],
    din:['VeloutÃ© potimarron-lait de coco','Salade lentilles-feta-noix','Escalope veau citron-cÃ¢pres','Poisson vapeur haricots verts','Soupe miso tofu soyeux','Cottage cheese-cruditÃ©s-pain complet','Edamame-riz complet-saumon fumÃ©']
  },
  fastfood:{
    dej:['Smash burger double fromage','Hot-dog maison moutarde-oignons','Wraps poulet-cheddar-salade','Kebab maison sauce blanche','Pizza maison margherita-roquette','Tacos mexicain poulet-guacamole','Burger vÃ©gÃ© halloumi-avocat'],
    din:['Nuggets poulet maison-frites four','Quesadillas fromage-haricots','Pizza blanche ricotta-champignons','Club sandwich toastÃ© jambon-Å“uf','Nachos haricots-fromage-guacamole','Naan-pizza chorizo-mozzarella','Panini thon-mozzarella-tomates']
  },
  veggie:{
    dej:['Curry de pois chiches-Ã©pinards','Tarte aux poireaux-brebis','Salade quinoa-betterave-chÃ¨vre','Risotto champignons-parmesan','Bowl riz-lÃ©gumes rÃ´tis-tahini','Galettes de lÃ©gumes sauce yaourt','Gnocchi Ã©pinards-ricotta'],
    din:['Soupe lentilles-cumin-citron','Å’ufs brouillÃ©s champignons-ciboulette','VeloutÃ© courgette-basilic','Tartelette tomates-moutarde-herbes','RÃ¶stis de courgettes-feta','Soupe potiron-graines de courge','Avocat farci quinoa-citron-herbes']
  },
  francais:{
    dej:['Pot-au-feu lÃ©gumes-bÅ“uf','Blanquette de veau riz crÃ©ole','BÅ“uf bourguignon express','Poulet rÃ´ti flageolets-ail','Salade de gÃ©siers confits-noix','Steak frites sauce au poivre','Navarin d\'agneau printanier'],
    din:['Vichyssoise froide poireaux','SoufflÃ© au comtÃ©','Gratin chou-fleur bÃ©chamel','Salade lyonnaise lardons-Å“uf pochÃ©','CrÃªpes salÃ©es jambon-champignons','PissaladiÃ¨re oignons-anchois','Veau Marengo & tagliatelles']
  },
  rapide:{
    dej:['PÃ¢tes ail-huile-parmesan','Sandwich jambon-beurre-cornichons','Salade composÃ©e thon-maÃ¯s-tomate','Omelette jambon-gruyÃ¨re','Toast avocat-Å“uf pochÃ©','Poulet marinÃ© express & salade','Bowl de cÃ©rÃ©ales lÃ©gumes rÃ´tis'],
    din:['Soupe lÃ©gumes surgelÃ©s-vermicelles','Tartines chÃ¨vre-miel-poire','Yaourt grec-granola-miel','Å’ufs Ã  la coque & mouillettes','Salade tomates-mozzarella-basilic','Soupe express miso-tofu','Pain perdu salÃ© jambon-herbes']
  },
  exotique:{
    dej:['MafÃ© sÃ©nÃ©galais poulet-arachides','Rendang bÅ“uf indonÃ©sien','Jerk chicken jamaÃ¯cain & riz-haricots','Dhal de lentilles rouges-naan','Shakshuka Å“ufs-tomates-harissa','Empanadas thon-olives au four','Pho bo vietnamien maison'],
    din:['Soupe tom yam aux crevettes','TabulÃ© persil-menthe-boulgour','Tortilla espagnole pomme de terre','Samoussas lÃ©gumes-curry four','Gaspacho andalou bien frais','Foul mÃ©damÃ¨s-ail-citron','Chapati-dhal express']
  },
  marmite:{
    dej:['Osso buco milanaise-gremolata','Poulet basquaise sauce piment','Coq au vin blanc-champignons','Tajine agneau-pruneaux-amandes','Joue de porc carottes-cÃ©leri','Saucisse-lentilles du Puy','Daube provenÃ§ale olives-herbes'],
    din:['VeloutÃ© poireaux-pommes de terre','Ratatouille au four provenÃ§ale','Cassoulet rapide haricots blancs','PotÃ©e auvergnate chou-saucisse','Gratin de crozets beaufortain','Soupe paysanne orge-lÃ©gumes','Soupe chÃ¢taignes-lard fumÃ©']
  },
  brunch:{
    dej:['Å’ufs BÃ©nÃ©dicte sauce hollandaise','Pancakes beurre-sirop d\'Ã©rable','Shakshuka poivrons-feta','Avocado toast Å“uf pochÃ©-sÃ©same','Omelette roulÃ©e jambon-herbes','CrÃªpes salÃ©es Ã©pinards-saumon fumÃ©','Bagel saumon fumÃ©-cream cheese'],
    din:['Frittata lÃ©gumes du frigo','Galette sarrasin jambon-Å“uf-fromage','Pain dorÃ© salÃ© chÃ¨vre-miel-romarin','VeloutÃ© d\'asperges Å“uf mollet','Tarte fine poireaux-saumon fumÃ©','Bowl aÃ§aÃ¯-granola-banane-myrtilles','Tartines nordiques hareng-betterave']
  },
  mer:{
    dej:['Moules mariniÃ¨res frites maison','Dos de cabillaud beurre blanc-cÃ¢pres','Salade crevettes avocat-pamplemousse','Linguine aux vongole','Tataki de thon sÃ©same-ponzu','Risotto aux fruits de mer','Saumon mi-cuit croÃ»te sÃ©same-miso'],
    din:['VeloutÃ© bisque de crevettes','Tartare saumon-avocat-citron vert','Sardines grillÃ©es citron-persil','Soupe de poisson rouille-croÃ»tons','Saint-Jacques poÃªlÃ©es purÃ©e cÃ©leri','Crevettes ail-beurre-persil','Carpaccio de dorade-huile d\'olive']
  },
  batch:{
    dej:['Bowl quinoa-lÃ©gumes rÃ´tis-pois chiches','Wrap poulet rÃ´ti-cruditÃ©s','Riz complet lentilles-carottes-cumin','Salade batch haricots-Å“uf-thon','Gratin de lÃ©gumes prÃ©parÃ© d\'avance','Soupe batch 5 lÃ©gumes-orge','PÃ¢tes froides pesto-tomates sÃ©chÃ©es-mozzarella'],
    din:['Soupe de lÃ©gumes batch du dimanche','Riz sautÃ© restes poulet-lÃ©gumes','Bowl froid quinoa-avocat-tahini','Tartines houmous-lÃ©gumes batch','Omelette restes lÃ©gumes rÃ´tis','Salade lentilles-herbes-vinaigrette','PurÃ©e pois chiches Ã©picÃ©e-cruditÃ©s']
  },
  saison:{
    dej:['VeloutÃ© cÃ©leri-rave-pomme verte','Endives braisÃ©es jambon-bÃ©chamel','Tarte tatin endives-chÃ¨vre-noix','Poireaux fondants vinaigrette-Å“uf mimosa','Risotto topinambour-noisettes-parmesan','Gratin chou blanc lardons-comtÃ©','Salade mÃ¢che betterave-noix-chÃ¨vre chaud'],
    din:['Soupe potimarron-gingembre-coco','Salade mÃ¢che-poire-noix-roquefort','VeloutÃ© poireaux-pomme de terre','RÃ¶stis de cÃ©leri-rave sauce moutarde','Soupe au chou vert-saucisse fumÃ©e','Betterave rÃ´tie four-feta-miel','Gratin courge butternut-gruyÃ¨re']
  },
  worldstreet:{
    dej:['Tacos al pastor porc-ananas','BÃ¡nh mÃ¬ poulet-pickles-coriandre','Falafel pita-houmous-tahini','Okonomiyaki japonais chou-porc','Arepas maÃ¯s-poulet-avocat','BÃ¶rek turc Ã©pinards-feta','Dosa crÃªpe indienne-chutney coco'],
    din:['Gyozas poÃªlÃ©s-vapeur sauce ponzu','GÃ¶zleme turc fromage-Ã©pinards','Samosas lÃ©gumes-menthe chutney','Tteokbokki gÃ¢teaux de riz Ã©picÃ©s','Momo tibÃ©tain vapeur-bÅ“uf','Elotes maÃ¯s grillÃ©-mayo-fromage','PÃ£o de queijo brÃ©silien fromage']
  },
  salades:{
    dej:['Salade CÃ©sar poulet grillÃ©-croÃ»tons','Bowl thaÃ¯ bÅ“uf-mangue-cacahuÃ¨tes','NiÃ§oise thon-haricots verts-anchois','Fattoush libanais-pain grillÃ©-sumac','Salade mexicaine poulet-haricots noirs','Salade boulgour-lÃ©gumes rÃ´tis-halloumi','Salade poulpe grillÃ©-pommes de terre'],
    din:['Salade lentilles beluga-betterave-chÃ¨vre','Panzanella tomates-pain-basilic','Salade kale-quinoa-grenade','Salade nordique saumon-pomme-aneth','Salade orzo-courgettes-feta-menthe','Waldorf revisitÃ©e poulet-cÃ©leri-noix','Salade riz complet-thon-herbes']
  },
  soupe:{
    dej:['Soupe pois cassÃ©s-lard fumÃ©','VeloutÃ© carottes-coco-gingembre','Minestrone complet pÃ¢tes-lÃ©gumes','Ramen maison poulet-champignons-nori','Harira marocaine agneau-pois chiches','Soupe tomates rÃ´ties-basilic','Goulash hongroise bÅ“uf-paprika'],
    din:['VeloutÃ© champignons-crÃ¨me-cerfeuil','Soupe Ã  l\'ail-pain-huile d\'olive','Pho vÃ©gÃ©tarien champignons-tofu','Soupe haricots blancs-romarin','Gazpacho betterave-yaourt-aneth','Soupe miso renforcÃ©e tofu-lÃ©gumes','Bouillon thaÃ¯ crevettes-citronnelle']
  },
  plancha:{
    dej:['Magret de canard plancha-figues','Crevettes plancha ail-beurre-citron','CÃ´te de porc plancha-moutarde-thym','LÃ©gumes grillÃ©s plancha-houmous','Saumon plancha sauce teriyaki-sÃ©same','Poulet marinÃ© citron-herbes plancha','Calamars plancha ail-persil-citron'],
    din:['Halloumi grillÃ©-tomates-olives','Gambas flambÃ©es cognac-beurre','LÃ©gumes saison grillÃ©s-pesto','Brochettes poulet-poivrons sauce yaourt','Saint-Jacques plancha-beurre blanc','Tomates farcies grillÃ©es plancha','Ananas grillÃ© coco-rhum-vanille']
  }
};

// â”€â”€ BASE DE RECETTES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var RECIPES = {
  'Salade grecque feta-olives':{temps:'10 min',diff:'Facile',ing:[['Tomates',2,'grosses'],['Concombre',0.5,''],['Feta',80,'g'],['Olives noires',50,'g'],['Oignon rouge',0.25,''],['Huile d\'olive',2,'c.s.'],['Origan sÃ©chÃ©',0.5,'c.c.'],['Citron',0.5,'']],steps:['Couper les tomates en quartiers et le concombre en demi-rondelles.','Ã‰mincer finement l\'oignon rouge.','Disposer tous les lÃ©gumes dans un plat, ajouter les olives.','Ã‰mietter grossiÃ¨rement la feta par-dessus.','Arroser d\'huile d\'olive et de jus de citron.','Saupoudrer d\'origan. Servir immÃ©diatement.'],tip:'Ne mÃ©langez pas â€” la salade grecque authentique se dresse en couches superposÃ©es.'},
  'Pasta tomates cerises-burrata':{temps:'15 min',diff:'Facile',ing:[['PÃ¢tes',100,'g'],['Tomates cerises',150,'g'],['Burrata',0.5,'boule'],['Ail',1,'gousse'],['Basilic frais',5,'feuilles'],['Huile d\'olive',2,'c.s.'],['Piment en flocons',1,'pincÃ©e']],steps:['Cuire les pÃ¢tes al dente. RÃ©server une louche d\'eau de cuisson.','Chauffer l\'huile, faire revenir l\'ail Ã©mincÃ© 1 min.','Ajouter les tomates cerises et cuire 6 min en les Ã©crasant lÃ©gÃ¨rement.','Verser les pÃ¢tes et un peu d\'eau de cuisson. MÃ©langer Ã  feu vif 1 min.','Dresser dans les assiettes avec la burrata au centre.','Ajouter le basilic, le piment et un filet d\'huile d\'olive.'],tip:'L\'eau de cuisson fÃ©culente lie la sauce et la fait adhÃ©rer aux pÃ¢tes.'},
  'Poulet teriyaki & riz jasmin':{temps:'20 min',diff:'Facile',ing:[['Filet de poulet',180,'g'],['Sauce soja',3,'c.s.'],['Miel',1.5,'c.s.'],['Vinaigre de riz',1,'c.s.'],['Riz jasmin',80,'g'],['Ail',1,'gousse'],['Gingembre rÃ¢pÃ©',1,'c.c.'],['Graines de sÃ©same',0.5,'c.c.']],steps:['Cuire le riz selon les indications du paquet.','MÃ©langer sauce soja, miel, vinaigre, ail et gingembre pour la marinade.','Couper le poulet en tranches. Saisir Ã  feu vif 3-4 min de chaque cÃ´tÃ©.','Verser la sauce teriyaki et laisser caramÃ©liser 2-3 min en retournant.','Servir sur le riz, parsemer de sÃ©same et de ciboule Ã©mincÃ©e.'],tip:'Ne lÃ©sinez pas sur la chaleur au dÃ©part â€” la croÃ»te caramÃ©lisÃ©e est l\'Ã¢me du teriyaki.'},
  'Bol de ramen poulet-miso':{temps:'25 min',diff:'Moyen',ing:[['Nouilles ramen',80,'g'],['Filet de poulet',150,'g'],['PÃ¢te miso',1,'c.s.'],['Bouillon de poulet',500,'ml'],['Å’uf',1,''],['Jeunes oignons',2,''],['Sauce soja',1,'c.s.'],['Gingembre',1,'c.c.']],steps:['Porter le bouillon Ã  Ã©bullition avec le miso, la sauce soja et le gingembre.','Pocher le poulet dans le bouillon 10 min, puis l\'effilocher.','Cuire les nouilles sÃ©parÃ©ment selon le paquet, Ã©goutter.','Faire un Å“uf mollet : 6 min dans l\'eau bouillante, puis eau froide, peler.','RÃ©partir les nouilles dans les bols, verser le bouillon chaud.','Garnir avec le poulet, l\'Å“uf coupÃ© en deux et les oignons Ã©mincÃ©s.'],tip:'Le miso ne doit jamais bouillir â€” il perd ses arÃ´mes. Ajoutez-le hors du feu.'},
  'Wok de bÅ“uf aux lÃ©gumes':{temps:'15 min',diff:'Facile',ing:[['BÅ“uf Ã©mincÃ©',150,'g'],['Poivron',1,''],['Courgette',1,''],['Carotte',1,''],['Sauce soja',2,'c.s.'],['Sauce huÃ®tre',1,'c.s.'],['Ail',2,'gousses'],['Huile de sÃ©same',1,'c.c.']],steps:['Ã‰mincer finement tous les lÃ©gumes et l\'ail.','Chauffer un wok Ã  feu trÃ¨s vif avec un peu d\'huile neutre.','Saisir le bÅ“uf 2 min en remuant. RÃ©server.','Dans le mÃªme wok, sauter les lÃ©gumes 3-4 min en gardant le croquant.','Remettre le bÅ“uf, verser sauce soja et sauce huÃ®tre.','MÃ©langer 1 min, arroser d\'huile de sÃ©same. Servir sur riz.'],tip:'Le wok doit fumer â€” une chaleur insuffisante donne des lÃ©gumes bouillis plutÃ´t que sautÃ©s.'},
  'Smash burger double fromage':{temps:'15 min',diff:'Facile',ing:[['BÅ“uf hachÃ© 15%MG',200,'g'],['Cheddar tranchÃ©',2,'tranches'],['Bun briochÃ©',1,''],['Oignon',0.5,''],['Cornichons',5,''],['Ketchup',1,'c.s.'],['Moutarde',1,'c.c.']],steps:['CaramÃ©liser l\'oignon Ã©mincÃ© 7 min au beurre Ã  feu doux.','Diviser la viande en 2 boules sans trop la travailler.','Chauffer une poÃªle en fonte Ã  feu trÃ¨s vif jusqu\'Ã  ce qu\'elle fume.','Poser une boule et aplatir fort avec une spatule. Saler. Cuire 1 min 30.','Retourner, poser le cheddar, couvrir 30 sec pour le faire fondre.','Toaster le bun. Monter : ketchup, oignons, cornichons, steaks, moutarde.'],tip:'La poÃªle doit vraiment fumer â€” c\'est la rÃ©action de Maillard qui crÃ©e la croÃ»te signature.'},
  'Quiche lorraine maison':{temps:'50 min',diff:'Moyen',ing:[['PÃ¢te brisÃ©e',0.25,'rouleau'],['Lardons fumÃ©s',100,'g'],['Å’ufs',2,''],['CrÃ¨me fraÃ®che Ã©paisse',150,'ml'],['GruyÃ¨re rÃ¢pÃ©',50,'g'],['Noix de muscade',1,'pincÃ©e']],steps:['PrÃ©chauffer le four Ã  180Â°C. Foncer un moule avec la pÃ¢te.','Faire revenir les lardons Ã  sec sans matiÃ¨re grasse. Ã‰goutter sur papier absorbant.','Battre les Å“ufs avec la crÃ¨me, la muscade, sel et poivre.','Cuire la pÃ¢te Ã  blanc 10 min avec des poids (haricots secs). Retirer les poids.','RÃ©partir les lardons, verser l\'appareil, parsemer de gruyÃ¨re.','Cuire 25-30 min. Le centre doit Ãªtre encore lÃ©gÃ¨rement tremblotant.'],tip:'L\'appareil tremblotant en sortie de four est normal â€” il finit de cuire en refroidissant et reste moelleux.'},
  'Risotto citron-parmesan':{temps:'30 min',diff:'Moyen',ing:[['Riz Arborio',80,'g'],['Bouillon de lÃ©gumes chaud',500,'ml'],['Parmesan rÃ¢pÃ©',50,'g'],['Beurre',30,'g'],['Oignon',0.5,''],['Vin blanc sec',80,'ml'],['Citron (zeste+jus)',0.5,''],['Huile d\'olive',1,'c.s.']],steps:['Faire suer l\'oignon dans l\'huile et la moitiÃ© du beurre pendant 4 min.','Ajouter le riz et nacrer 2 min en remuant pour enrober chaque grain.','DÃ©glacer au vin blanc. Remuer jusqu\'Ã  absorption complÃ¨te.','Ajouter le bouillon louche par louche en remuant constamment pendant 18 min.','Hors du feu, incorporer le beurre restant, le parmesan, le zeste et le jus de citron.','Couvrir 2 min puis servir dans des assiettes creuses chaudes.'],tip:'La mantecatura â€” beurre + parmesan hors du feu â€” est le secret du risotto crÃ©meux et liÃ©.'},
  'Curry de pois chiches-Ã©pinards':{temps:'20 min',diff:'Facile',ing:[['Pois chiches en boÃ®te',200,'g'],['Ã‰pinards frais',100,'g'],['Tomates concassÃ©es',200,'g'],['Lait de coco',100,'ml'],['Oignon',1,''],['Ail',2,'gousses'],['Garam masala',1,'c.c.'],['Riz basmati',80,'g']],steps:['Cuire le riz basmati selon les indications du paquet.','Faire revenir l\'oignon Ã©mincÃ© 5 min dans un filet d\'huile.','Ajouter l\'ail hachÃ©, le garam masala et une pincÃ©e de curcuma. Cuire 1 min.','Verser les tomates concassÃ©es et cuire 5 min jusqu\'Ã  lÃ©gÃ¨re rÃ©duction.','Ajouter le lait de coco et les pois chiches Ã©gouttÃ©s. Mijoter 8 min.','Incorporer les Ã©pinards, mÃ©langer jusqu\'Ã  ce qu\'ils tombent. Servir sur le riz.'],tip:'Une cuillÃ¨re de jus de citron en fin de cuisson rÃ©veille tous les arÃ´mes du curry.'},
  'Toast avocat-Å“uf pochÃ©':{temps:'12 min',diff:'Facile',ing:[['Pain complet ou seigle',2,'tranches'],['Avocat mÃ»r',1,''],['Å’uf',1,''],['Citron',0.25,''],['Piment en flocons',1,'pincÃ©e'],['Graines de sÃ©same',0.5,'c.c.'],['Fleur de sel',1,'pincÃ©e']],steps:['Toaster le pain Ã  votre goÃ»t.','Ã‰craser l\'avocat avec le jus de citron, sel et poivre. Garder de la texture.','Porter de l\'eau Ã  frÃ©missement avec un filet de vinaigre blanc.','CrÃ©er un lÃ©ger tourbillon, casser l\'Å“uf dans un petit bol et le glisser doucement.','Cuire 3 min exactement. Ã‰goutter sur papier absorbant.','Ã‰taler l\'avocat sur le toast, poser l\'Å“uf, parsemer de sÃ©same, piment et fleur de sel.'],tip:'Blanc entiÃ¨rement pris, jaune encore coulant = 3 minutes chrono. Pas une de plus.'},
  'Shakshuka Å“ufs-tomates-harissa':{temps:'25 min',diff:'Facile',ing:[['Å’ufs',2,''],['Tomates concassÃ©es',400,'g'],['Poivron rouge',1,''],['Oignon',1,''],['Harissa',1,'c.c.'],['Cumin & paprika',1,'c.c. chacun'],['Ail',2,'gousses'],['Coriandre fraÃ®che',5,'brins']],steps:['Faire revenir l\'oignon et le poivron coupÃ©s en dÃ©s pendant 5 min.','Ajouter l\'ail hachÃ©, le cumin, le paprika et la harissa. Cuire 1 min.','Verser les tomates concassÃ©es. Assaisonner. Cuire 10 min jusqu\'Ã  sauce Ã©paissie.','CrÃ©er des niches dans la sauce avec une cuillÃ¨re, casser un Å“uf dans chacune.','Couvrir et cuire 5-7 min : blanc pris, jaune encore coulant.','Parsemer de coriandre et servir avec du pain pita chaud.'],tip:'Surveillez Ã  partir de 5 min â€” un jaune encore tremblotant, c\'est le moment idÃ©al.'},
  'PÃ¢tes carbonara Ã  la franÃ§aise':{temps:'20 min',diff:'Moyen',ing:[['Spaghetti',100,'g'],['Lardons fumÃ©s',80,'g'],['Å’ufs',2,''],['Parmesan ou gruyÃ¨re rÃ¢pÃ©',50,'g'],['CrÃ¨me fraÃ®che',1,'c.s.'],['Poivre noir',1,'pincÃ©e gÃ©nÃ©reuse'],['Ail',1,'gousse']],steps:['Cuire les spaghetti al dente. RÃ©server une grande tasse d\'eau de cuisson.','Faire revenir les lardons et l\'ail Ã  sec jusqu\'Ã  dorure.','Dans un bol, mÃ©langer les Å“ufs entiers, la crÃ¨me, le fromage et le poivre noir.','Ã‰goutter les pÃ¢tes et les verser dans la poÃªle hors du feu avec les lardons.','Verser le mÃ©lange Å“uf-fromage en mÃ©langeant vigoureusement. Ajouter de l\'eau de cuisson si besoin.','La sauce doit Ãªtre crÃ©meuse et napper les pÃ¢tes â€” jamais brouillÃ©e.'],tip:'Hors du feu est la rÃ¨gle absolue â€” la chaleur rÃ©siduelle des pÃ¢tes suffit pour cuire les Å“ufs.'},
  'Salade CÃ©sar poulet grillÃ©-croÃ»tons':{temps:'20 min',diff:'Facile',ing:[['Filet de poulet',150,'g'],['Laitue romaine',0.5,''],['CroÃ»tons Ã  l\'ail',30,'g'],['Parmesan',25,'g'],['Mayonnaise',1,'c.s.'],['Anchois en boÃ®te',1,'filet'],['Ail',0.5,'gousse'],['Jus de citron',1,'c.s.']],steps:['Assaisonner le poulet. Cuire Ã  la poÃªle 5-6 min de chaque cÃ´tÃ©. Laisser reposer 3 min puis trancher.','PrÃ©parer la sauce : Ã©craser l\'anchois et l\'ail, mÃ©langer avec la mayonnaise et le citron.','DÃ©chirer la romaine en morceaux grossiers.','MÃ©langer la romaine avec la sauce CÃ©sar.','Dresser avec les tranches de poulet, les croÃ»tons et les copeaux de parmesan.','Poivrer gÃ©nÃ©reusement au moulin.'],tip:'L\'anchois dans la sauce CÃ©sar est indispensable â€” il donne l\'umami qui rend la sauce addictive, sans goÃ»t de poisson.'},
  'Moules mariniÃ¨res frites maison':{temps:'25 min',diff:'Facile',ing:[['Moules fraÃ®ches',500,'g'],['Vin blanc sec',150,'ml'],['Ã‰chalotes',2,''],['Ail',1,'gousse'],['Persil plat',0.5,'bouquet'],['Beurre',30,'g'],['Pommes de terre',250,'g']],steps:['Gratter et laver soigneusement les moules. Jeter celles ouvertes qui ne se referment pas au toucher.','PrÃ©chauffer le four Ã  200Â°C. Couper les pommes de terre en frites, huiler, saler, enfourner 20 min.','Faire revenir les Ã©chalotes et l\'ail dans le beurre 2 min.','Verser le vin blanc et porter Ã  Ã©bullition.','Ajouter les moules, couvrir et cuire Ã  feu vif 3-5 min jusqu\'Ã  ouverture.','Parsemer de persil hachÃ©. Jeter celles restÃ©es fermÃ©es. Servir avec les frites.'],tip:'Les moules fermÃ©es avant cuisson et ouvertes aprÃ¨s â€” c\'est la rÃ¨gle d\'or de fraÃ®cheur.'},
  'Dos de cabillaud beurre blanc-cÃ¢pres':{temps:'20 min',diff:'Moyen',ing:[['Dos de cabillaud',180,'g'],['Beurre',60,'g'],['Ã‰chalote',1,''],['Vin blanc',50,'ml'],['CÃ¢pres',1,'c.s.'],['Citron',0.5,''],['Aneth frais',3,'brins']],steps:['Saler et poivrer le cabillaud. Saisir cÃ´tÃ© peau dans une poÃªle chaude huilÃ©e 4 min.','Retourner dÃ©licatement et cuire 3 min cÃ´tÃ© chair. RÃ©server au chaud.','Dans une petite casserole, faire rÃ©duire le vin blanc avec l\'Ã©chalote Ã©mincÃ©e.','Hors du feu, incorporer le beurre froid en dÃ©s en fouettant vigoureusement.','Ajouter les cÃ¢pres, le jus de citron et l\'aneth. Assaisonner.','Napper le cabillaud de beurre blanc et servir immÃ©diatement.'],tip:'Le beurre blanc monte hors du feu â€” la chaleur directe le ferait trancher immÃ©diatement.'},
  'Poulet basquaise sauce piment':{temps:'45 min',diff:'Moyen',ing:[['Cuisses de poulet',2,''],['Poivrons rouges et verts',2,''],['Tomates concassÃ©es',300,'g'],['Oignon',1,''],['Piment d\'Espelette',1,'c.c.'],['Ail',3,'gousses'],['Thym & laurier',1,'branche chacun'],['Huile d\'olive',2,'c.s.']],steps:['Faire dorer les cuisses de poulet Ã  feu vif dans l\'huile, 5 min de chaque cÃ´tÃ©. RÃ©server.','Dans la mÃªme cocotte, faire revenir l\'oignon et les poivrons en laniÃ¨res 8 min.','Ajouter l\'ail, le thym, le laurier et le piment d\'Espelette. Cuire 2 min.','Verser les tomates concassÃ©es. Remettre le poulet. Couvrir et mijoter 30 min Ã  feu doux.','VÃ©rifier l\'assaisonnement. La sauce doit Ãªtre Ã©paisse et fondante.','Servir avec du riz blanc ou des pommes de terre vapeur.'],tip:'Le piment d\'Espelette se met en fin de cuisson pour conserver tout son parfum et sa couleur.'},
  'BÅ“uf bourguignon express':{temps:'40 min',diff:'Moyen',ing:[['BÅ“uf Ã  braiser',200,'g'],['Lardons fumÃ©s',80,'g'],['Champignons de Paris',100,'g'],['Vin rouge Bourgogne',200,'ml'],['Oignons grelots',6,''],['Bouquet garni',1,''],['Farine',1,'c.s.'],['Beurre',20,'g']],steps:['Couper le bÅ“uf en cubes de 3 cm. Fariner lÃ©gÃ¨rement.','Faire dorer les lardons et les oignons dans le beurre. RÃ©server.','Saisir le bÅ“uf Ã  feu vif sur toutes les faces dans la mÃªme cocotte.','DÃ©glacer au vin rouge en grattant les sucs. Ajouter le bouquet garni.','Remettre lardons et oignons. Couvrir et mijoter 30 min Ã  feu doux.','Ajouter les champignons Ã©mincÃ©s les 10 derniÃ¨res minutes. Retirer le bouquet garni.'],tip:'Un bourguignon est encore meilleur rÃ©chauffÃ© le lendemain â€” prÃ©parez-le la veille.'},
  'Gratin dauphinois & jambon cru':{temps:'70 min',diff:'Facile',ing:[['Pommes de terre Ã  chair ferme',400,'g'],['CrÃ¨me liquide entiÃ¨re',200,'ml'],['Lait',100,'ml'],['Ail',1,'gousse'],['Noix de muscade',1,'pincÃ©e'],['GruyÃ¨re rÃ¢pÃ©',50,'g'],['Jambon cru',3,'tranches']],steps:['PrÃ©chauffer le four Ã  160Â°C. Frotter un plat Ã  gratin avec l\'ail coupÃ© en deux.','Ã‰plucher et trancher finement les pommes de terre (2 mm) sans les rincer.','MÃ©langer la crÃ¨me et le lait avec la muscade, sel et poivre.','Disposer les pommes de terre en couches dans le plat. Verser l\'appareil crÃ¨me-lait.','Parsemer de gruyÃ¨re. Cuire 60-70 min jusqu\'Ã  dorure et pommes de terre fondantes.','Servir avec les tranches de jambon cru dressÃ©es Ã  cÃ´tÃ©.'],tip:'Sans rinÃ§age, les pommes de terre gardent leur amidon qui lie naturellement le gratin.'},
  'Omelette jambon-champignons':{temps:'10 min',diff:'Facile',ing:[['Å’ufs',3,''],['Champignons de Paris',80,'g'],['Jambon blanc',1,'tranche'],['Beurre',15,'g'],['Ciboulette',4,'brins'],['Sel & poivre',1,'pincÃ©e']],steps:['Ã‰mincer les champignons et les faire sauter au beurre 3 min. RÃ©server.','Couper le jambon en dÃ©s.','Battre les Å“ufs avec sel, poivre et la ciboulette ciselÃ©e.','Faire fondre le reste de beurre dans une poÃªle anti-adhÃ©sive Ã  feu moyen-vif.','Verser les Å“ufs. Remuer les bords vers le centre Ã  la spatule pendant 30 sec.','RÃ©partir champignons et jambon sur une moitiÃ©. Replier et glisser dans l\'assiette.'],tip:'Une omelette se roule, ne se casse pas â€” le secret est un feu moyen-vif et un mouvement continu.'},
  'Poulet rÃ´ti flageolets-ail':{temps:'75 min',diff:'Facile',ing:[['Poulet entier',1,''],['Flageolets en boÃ®te',200,'g'],['Ail',1,'tÃªte'],['Thym & romarin',2,'branches'],['Beurre',40,'g'],['Huile d\'olive',2,'c.s.'],['Citron',1,'']],steps:['PrÃ©chauffer le four Ã  200Â°C.','Frotter le poulet avec le beurre ramolli, sel, poivre et les herbes. Glisser le citron coupÃ© Ã  l\'intÃ©rieur.','Disposer dans un plat avec la tÃªte d\'ail entiÃ¨re. Arroser d\'huile.','RÃ´tir 1h Ã  200Â°C en arrosant toutes les 20 min avec le jus de cuisson.','Les 10 derniÃ¨res minutes, ajouter les flageolets Ã©gouttÃ©s autour du poulet.','Laisser reposer 10 min avant de dÃ©couper. Servir avec le jus de cuisson.'],tip:'Laisser reposer le poulet avant de dÃ©couper permet aux jus de se redistribuer â€” viande bien plus moelleuse.'},
  'VeloutÃ© carottes-coco-gingembre':{temps:'25 min',diff:'Facile',ing:[['Carottes',400,'g'],['Lait de coco',200,'ml'],['Bouillon de lÃ©gumes',400,'ml'],['Oignon',1,''],['Gingembre frais',2,'c.c.'],['Ail',1,'gousse'],['Huile d\'olive',1,'c.s.'],['Coriandre fraÃ®che',3,'brins']],steps:['Ã‰plucher et couper les carottes en rondelles, l\'oignon en quartiers.','Faire revenir l\'oignon et l\'ail dans l\'huile 3 min.','Ajouter les carottes, le gingembre rÃ¢pÃ© et le bouillon. Cuire 20 min.','Mixer finement avec le lait de coco jusqu\'Ã  obtenir un veloutÃ© lisse.','Ajuster la consistance avec un peu de bouillon si nÃ©cessaire.','Servir parsemÃ© de coriandre fraÃ®che et d\'un filet de lait de coco.'],tip:'Un filet de citron vert en finition Ã©quilibre la douceur des carottes et du coco.'},
  'Soupe pho bÅ“uf-herbes':{temps:'30 min',diff:'Moyen',ing:[['Bouillon de bÅ“uf',600,'ml'],['BÅ“uf Ã  fondue Ã©mincÃ©',120,'g'],['Nouilles de riz',80,'g'],['Anis Ã©toilÃ©',2,''],['Cannelle',0.25,'bÃ¢ton'],['Gingembre',2,'tranches'],['Germes de soja',30,'g'],['Basilic thaÃ¯ & menthe',5,'feuilles chacun']],steps:['Faire griller le gingembre et les Ã©pices Ã  sec dans une casserole 2 min pour les torrÃ©fier.','Verser le bouillon de bÅ“uf et laisser infuser Ã  frÃ©missement 20 min. Filtrer.','Cuire les nouilles de riz selon le paquet, Ã©goutter, rÃ©partir dans les bols.','Porter le bouillon Ã  Ã©bullition. Y plonger les tranches de bÅ“uf 30 sec â€” elles cuisent dans le bol.','Verser le bouillon brÃ»lant sur la viande et les nouilles.','Garnir de germes de soja, basilic thaÃ¯, menthe et quartiers de citron vert.'],tip:'Le secret du pho est dans le bouillon â€” les Ã©pices grillÃ©es Ã  sec dÃ©cuplent leurs arÃ´mes.'},
  'Pad thaÃ¯ aux crevettes':{temps:'20 min',diff:'Moyen',ing:[['Nouilles de riz plates',80,'g'],['Crevettes dÃ©cortiquÃ©es',120,'g'],['Å’uf',1,''],['Germes de soja',50,'g'],['CacahuÃ¨tes grillÃ©es',20,'g'],['Sauce nuoc-mÃ¢m',2,'c.s.'],['Sucre de palme ou cassonade',1,'c.s.'],['Citron vert',0.5,'']],steps:['Tremper les nouilles dans de l\'eau chaude 15 min. Ã‰goutter.','Chauffer un wok Ã  feu trÃ¨s vif. Sauter les crevettes 2 min. RÃ©server.','Faire revenir l\'ail hachÃ©, ajouter les nouilles et mÃ©langer 2 min.','Pousser sur le cÃ´tÃ©, casser l\'Å“uf, brouiller puis incorporer aux nouilles.','Ajouter la sauce nuoc-mÃ¢m, le sucre, les crevettes et les germes de soja.','Servir avec les cacahuÃ¨tes concassÃ©es, le citron vert et du piment.'],tip:'Le sucre de palme est indispensable pour l\'Ã©quilibre sucrÃ©-salÃ©-acidulÃ© typique du pad thaÃ¯.'},
  'Saumon grillÃ© lentilles-lÃ©gumes':{temps:'20 min',diff:'Facile',ing:[['PavÃ© de saumon',180,'g'],['Lentilles vertes en boÃ®te',150,'g'],['Carotte',1,''],['CÃ©leri',1,'branche'],['Moutarde Ã  l\'ancienne',1,'c.c.'],['Vinaigre de vin',1,'c.s.'],['Huile d\'olive',2,'c.s.'],['Persil plat',3,'brins']],steps:['Couper la carotte et le cÃ©leri en petits dÃ©s. Faire revenir 5 min dans l\'huile.','Rincer et Ã©goutter les lentilles. Les ajouter aux lÃ©gumes.','PrÃ©parer une vinaigrette avec la moutarde, le vinaigre et l\'huile restante.','Assaisonner les lentilles chaudes avec la vinaigrette. Parsemer de persil.','Saler et poivrer le saumon. Cuire cÃ´tÃ© peau 4 min dans une poÃªle chaude.','Retourner 2 min cÃ´tÃ© chair pour garder le cÅ“ur nacrÃ©. Servir sur les lentilles.'],tip:'Le saumon mi-cuit, nacrÃ© au centre, a une texture fondante incomparable â€” ne surcuisez pas.'},
  'Tartare saumon-avocat-citron vert':{temps:'15 min',diff:'Facile',ing:[['Saumon trÃ¨s frais',180,'g'],['Avocat',1,''],['Citron vert',1,''],['Ã‰chalote',1,'petite'],['Aneth frais',4,'brins'],['Huile d\'olive',1,'c.s.'],['Sauce soja',1,'c.c.'],['Sel & poivre',1,'']],steps:['VÃ©rifier que le saumon est bien frais (couleur vive, pas d\'odeur forte).','Couper le saumon en petits dÃ©s rÃ©guliers de 8 mm.','Couper l\'avocat en dÃ©s similaires. Arroser immÃ©diatement de jus de citron vert.','Ã‰mincer finement l\'Ã©chalote. Ciseler l\'aneth.','MÃ©langer dÃ©licatement tous les ingrÃ©dients avec l\'huile et la sauce soja.','Dresser Ã  l\'emporte-piÃ¨ce ou en dÃ´me. Servir immÃ©diatement.'],tip:'PrÃ©parez le tartare au dernier moment et ne le laissez jamais plus de 30 min au froid.'},
  'VeloutÃ© champignons-crÃ¨me-cerfeuil':{temps:'20 min',diff:'Facile',ing:[['Champignons de Paris',300,'g'],['CrÃ¨me fraÃ®che',100,'ml'],['Bouillon de lÃ©gumes',400,'ml'],['Ã‰chalotes',2,''],['Beurre',20,'g'],['Cerfeuil frais',5,'brins'],['Jus de citron',1,'c.c.']],steps:['Ã‰mincer les Ã©chalotes et les champignons.','Faire suer les Ã©chalotes dans le beurre 3 min.','Ajouter les champignons et cuire 8 min jusqu\'Ã  Ã©vaporation de l\'eau de vÃ©gÃ©tation.','Verser le bouillon et porter Ã  frÃ©missement 10 min.','Mixer finement avec la crÃ¨me. Assaisonner, ajouter le jus de citron.','Servir avec quelques feuilles de cerfeuil et un trait de crÃ¨me.'],tip:'Citron en fin de cuisson : une touche d\'aciditÃ© qui rÃ©veille les arÃ´mes terreux des champignons.'},
  'Galette sarrasin jambon-Å“uf-fromage':{temps:'15 min',diff:'Facile',ing:[['Farine de sarrasin',80,'g'],['Eau',200,'ml'],['Å’uf',1,''],['Jambon blanc',1,'tranche'],['Emmental rÃ¢pÃ©',30,'g'],['Beurre',10,'g'],['Sel',1,'pincÃ©e']],steps:['PrÃ©parer la pÃ¢te : mÃ©langer la farine de sarrasin, l\'eau, une pincÃ©e de sel. Laisser reposer 30 min.','Beurrer une crÃªpiÃ¨re bien chaude.','Verser une louche de pÃ¢te et Ã©taler rapidement en disque fin.','Casser l\'Å“uf au centre. Disposer le jambon et l\'emmental sur les bords.','Replier les quatre cÃ´tÃ©s pour former un carrÃ©. Cuire encore 2 min.','Servir immÃ©diatement avec une salade verte.'],tip:'La crÃªpiÃ¨re doit Ãªtre trÃ¨s chaude pour que la galette soit croustillante et non molle.'},
  'Frittata lÃ©gumes du frigo':{temps:'20 min',diff:'Facile',ing:[['Å’ufs',3,''],['LÃ©gumes variÃ©s (courgette, poivron, champignon)',200,'g'],['Parmesan rÃ¢pÃ©',30,'g'],['Ail',1,'gousse'],['Huile d\'olive',1,'c.s.'],['Basilic ou thym',3,'brins'],['Sel & poivre',1,'pincÃ©e']],steps:['PrÃ©chauffer le gril du four.','Couper les lÃ©gumes en petits morceaux. Faire revenir avec l\'ail dans l\'huile 5-7 min.','Battre les Å“ufs avec le parmesan, sel, poivre et les herbes.','Verser les Å“ufs sur les lÃ©gumes dans la poÃªle allant au four.','Cuire Ã  feu doux 5 min jusqu\'Ã  ce que les bords soient pris.','Passer sous le gril 3-4 min pour dorer le dessus. Servir tiÃ¨de ou froid.'],tip:'La frittata est idÃ©ale pour vider le frigo â€” presque tous les lÃ©gumes cuits ou crus fonctionnent.'},
  'CrÃªpes salÃ©es Ã©pinards-saumon fumÃ©':{temps:'20 min',diff:'Facile',ing:[['Farine',80,'g'],['Å’uf',1,''],['Lait',200,'ml'],['Ã‰pinards frais',60,'g'],['Saumon fumÃ©',60,'g'],['CrÃ¨me fraÃ®che',2,'c.s.'],['Jus de citron',1,'c.c.'],['Aneth frais',3,'brins']],steps:['MÃ©langer la farine, l\'Å“uf et le lait pour la pÃ¢te Ã  crÃªpe. Laisser reposer 15 min.','Faire tomber les Ã©pinards Ã  la poÃªle avec un peu de beurre. Saler.','Cuire les crÃªpes dans une crÃªpiÃ¨re beurrÃ©e, environ 2 min de chaque cÃ´tÃ©.','MÃ©langer la crÃ¨me fraÃ®che avec le citron et l\'aneth ciselÃ©.','Garnir chaque crÃªpe : crÃ¨me citronnÃ©e, Ã©pinards, saumon fumÃ©.','Rouler ou plier en triangle. Servir immÃ©diatement.'],tip:'Reposer la pÃ¢te 15 min minimum permet au gluten de se dÃ©tendre et aux crÃªpes d\'Ãªtre plus lÃ©gÃ¨res.'},
  'Tagine poulet-citron confit':{temps:'50 min',diff:'Moyen',ing:[['Cuisses de poulet',2,''],['Citron confit',1,''],['Olives vertes',40,'g'],['Oignon',1,''],['Ail',2,'gousses'],['Cumin, coriandre, curcuma',0.5,'c.c. chacun'],['Bouillon de poulet',200,'ml'],['Coriandre fraÃ®che',5,'brins']],steps:['Faire dorer les cuisses de poulet dans l\'huile d\'olive 5 min de chaque cÃ´tÃ©. RÃ©server.','Faire revenir l\'oignon Ã©mincÃ© 5 min. Ajouter l\'ail et toutes les Ã©pices. Cuire 1 min.','Remettre le poulet dans la cocotte. Verser le bouillon.','Couper le citron confit en quartiers, retirer la pulpe, ajouter la peau aux poulet.','Couvrir et mijoter 35 min Ã  feu doux. Ajouter les olives les 10 derniÃ¨res minutes.','Parsemer de coriandre fraÃ®che. Servir avec de la semoule.'],tip:'La pulpe du citron confit est trop salÃ©e â€” n\'utilisez que la peau, c\'est elle qui parfume.'},
  'Pot-au-feu lÃ©gumes-bÅ“uf':{temps:'120 min',diff:'Facile',ing:[['BÅ“uf (plat de cÃ´te ou paleron)',300,'g'],['Carottes',3,''],['Poireaux',2,''],['Navets',2,''],['Pommes de terre',2,''],['Bouquet garni',1,''],['Clou de girofle',2,''],['Os Ã  moelle',2,'']],steps:['Mettre le bÅ“uf et les os dans une grande casserole d\'eau froide. Porter Ã  Ã©bullition.','Ã‰cumer soigneusement pendant 5 min pour obtenir un bouillon limpide.','Ajouter le bouquet garni et les clous de girofle. Saler. Cuire 1h Ã  frÃ©missement.','Ajouter les carottes, navets et poireaux. Cuire 30 min.','Ajouter les pommes de terre. Cuire encore 20 min.','Servir la viande avec les lÃ©gumes et le bouillon. Cornichons et moutarde Ã  part.'],tip:'L\'Ã©cumage est essentiel â€” ces premiÃ¨res impuretÃ©s donnent de l\'amertume au bouillon.'},
  'Soupe minestrone aux lÃ©gumes':{temps:'30 min',diff:'Facile',ing:[['Tomates concassÃ©es',200,'g'],['Courgette',1,''],['Carotte',1,''],['CÃ©leri',1,'branche'],['Haricots blancs en boÃ®te',100,'g'],['Petites pÃ¢tes',40,'g'],['Oignon',1,''],['Parmesan',20,'g']],steps:['Faire revenir l\'oignon Ã©mincÃ© dans l\'huile d\'olive 3 min.','Ajouter les lÃ©gumes coupÃ©s en dÃ©s. Faire revenir 5 min.','Verser les tomates et 700 ml d\'eau ou bouillon. Cuire 15 min.','Ajouter les haricots blancs et les pÃ¢tes. Cuire encore 10 min.','Ajuster l\'assaisonnement. Le minestrone doit Ãªtre Ã©pais.','Servir avec du parmesan rÃ¢pÃ© et un filet d\'huile d\'olive.'],tip:'Un morceau de croÃ»te de parmesan ajoutÃ© pendant la cuisson donne une profondeur de goÃ»t unique.'},
  'Penne Ã  l\'arrabbiata':{temps:'20 min',diff:'Facile',ing:[['Penne',100,'g'],['Tomates pelÃ©es en boÃ®te',400,'g'],['Ail',3,'gousses'],['Piment rouge sÃ©chÃ©',1,''],['Huile d\'olive',3,'c.s.'],['Persil plat',5,'brins'],['Sel',1,'pincÃ©e']],steps:['Chauffer l\'huile Ã  feu moyen. Faire revenir l\'ail tranchÃ© et le piment 2 min.','Ajouter les tomates pelÃ©es et les Ã©craser grossiÃ¨rement.','Assaisonner. Cuire la sauce 15 min Ã  feu vif jusqu\'Ã  Ã©paississement.','Cuire les penne al dente. RÃ©server une louche d\'eau de cuisson.','Verser les pÃ¢tes dans la sauce avec un peu d\'eau de cuisson. MÃ©langer 1 min.','Parsemer de persil hachÃ©. Pas de parmesan sur l\'arrabbiata !'],tip:'Arrabbiata signifie "en colÃ¨re" en italien â€” le niveau de piment est Ã  votre goÃ»t et Ã  votre tÃ©mÃ©ritÃ©.'},
  'Omelette baveuse champignons-comtÃ©':{temps:'10 min',diff:'Facile',ing:[['Å’ufs',3,''],['Champignons de Paris',80,'g'],['ComtÃ© rÃ¢pÃ©',30,'g'],['Beurre',15,'g'],['Ciboulette',4,'brins'],['Sel & poivre',1,'pincÃ©e']],steps:['Ã‰mincer les champignons. Faire sauter dans la moitiÃ© du beurre 4 min. Saler.','Battre les Å“ufs vigoureusement avec sel, poivre et la ciboulette ciselÃ©e.','Faire fondre le reste du beurre dans une poÃªle Ã  feu moyen-vif.','Verser les Å“ufs. Remuer constamment avec une spatule plate pendant 30-40 sec.','Quand le dessous est pris mais le dessus encore baveux, ajouter champignons et comtÃ©.','Rouler l\'omelette et la faire glisser dans l\'assiette. Servir immÃ©diatement.'],tip:'Une omelette baveuse doit Ãªtre servie dans la seconde â€” elle continue de cuire dans l\'assiette.'},
  'Soupe Ã  l\'oignon gratinÃ©e':{temps:'45 min',diff:'Facile',ing:[['Oignons',4,''],['Bouillon de bÅ“uf',700,'ml'],['Beurre',40,'g'],['Vin blanc sec',100,'ml'],['GruyÃ¨re rÃ¢pÃ©',80,'g'],['Pain de campagne',2,'tranches Ã©paisses'],['Sucre',0.5,'c.c.'],['Thym',2,'branches']],steps:['Ã‰mincer trÃ¨s finement les oignons. Faire fondre dans le beurre Ã  feu doux.','Ajouter le sucre. Cuire 25-30 min en remuant rÃ©guliÃ¨rement jusqu\'Ã  caramÃ©lisation dorÃ©e.','DÃ©glacer au vin blanc. Ajouter le bouillon et le thym. Cuire 15 min.','Toaster les tranches de pain. PrÃ©chauffer le gril du four.','RÃ©partir la soupe dans des bols allant au four. Poser le pain dessus.','Couvrir de gruyÃ¨re rÃ¢pÃ© et gratiner sous le gril 4-5 min.'],tip:'La patience est la clÃ© â€” les oignons doivent caramÃ©liser lentement pour dÃ©velopper leur sucre naturel.'},
  'Coq au vin blanc-champignons':{temps:'60 min',diff:'Moyen',ing:[['Poulet dÃ©coupÃ©',0.5,'poulet'],['Champignons de Paris',150,'g'],['Vin blanc sec',300,'ml'],['Lardons',80,'g'],['Oignons grelots',8,''],['CrÃ¨me fraÃ®che',100,'ml'],['Bouquet garni',1,''],['Farine',1,'c.s.']],steps:['Faire dorer les morceaux de poulet dans le beurre sur toutes les faces. RÃ©server.','Dans la mÃªme cocotte, faire revenir les lardons et les oignons grelots 5 min.','Saupoudrer de farine, mÃ©langer 1 min. DÃ©glacer au vin blanc.','Remettre le poulet, ajouter le bouquet garni. Couvrir et mijoter 40 min.','Ajouter les champignons Ã©mincÃ©s les 10 derniÃ¨res minutes.','Incorporer la crÃ¨me fraÃ®che hors du feu. Ajuster l\'assaisonnement.'],tip:'Le vin blanc doit Ãªtre de bonne qualitÃ© â€” un vin que vous boiriez, pas un "vin Ã  cuisiner".'},
  'Nuggets poulet maison-frites four':{temps:'30 min',diff:'Facile',ing:[['Filets de poulet',180,'g'],['Chapelure',50,'g'],['Parmesan rÃ¢pÃ©',20,'g'],['Å’uf',1,''],['Paprika',0.5,'c.c.'],['Pommes de terre',250,'g'],['Huile d\'olive',2,'c.s.']],steps:['PrÃ©chauffer le four Ã  200Â°C. Couper les pommes de terre en frites, mÃ©langer Ã  l\'huile, saler.','Enfourner les frites 25 min en les retournant Ã  mi-cuisson.','Couper le poulet en gros morceaux de 3 cm.','MÃ©langer chapelure, parmesan, paprika, sel, poivre.','Tremper chaque morceau dans l\'Å“uf battu puis dans la chapelure.','DÃ©poser sur papier cuisson. Enfourner 15 min en retournant Ã  mi-cuisson.'],tip:'Un filet d\'huile sur les nuggets avant cuisson leur donne une belle dorure sans friture.'},
  'Saumon plancha sauce teriyaki-sÃ©same':{temps:'15 min',diff:'Facile',ing:[['PavÃ© de saumon',180,'g'],['Sauce soja',2,'c.s.'],['Miel',1,'c.s.'],['Vinaigre de riz',0.5,'c.s.'],['SÃ©same',1,'c.c.'],['Riz',80,'g'],['Gingembre rÃ¢pÃ©',0.5,'c.c.']],steps:['Cuire le riz selon le paquet.','MÃ©langer sauce soja, miel, vinaigre de riz et gingembre.','Chauffer la plancha ou une poÃªle Ã  feu vif.','Cuire le saumon cÃ´tÃ© peau 4 min, retourner 2 min cÃ´tÃ© chair.','Verser la sauce teriyaki sur le saumon en fin de cuisson, laisser caramÃ©liser 1 min.','Servir sur le riz avec des graines de sÃ©same et du concombre tranchÃ©.'],tip:'CÃ´tÃ© peau en premier et Ã  feu vif â€” Ã§a croustille et empÃªche le saumon de coller.'},
  'Crevettes plancha ail-beurre-citron':{temps:'10 min',diff:'Facile',ing:[['Crevettes crues',200,'g'],['Beurre',30,'g'],['Ail',3,'gousses'],['Citron',0.5,''],['Persil plat',5,'brins'],['Piment d\'Espelette',0.5,'c.c.'],['Sel',1,'pincÃ©e']],steps:['DÃ©cortiquer les crevettes en gardant la queue. SÃ©cher avec du papier absorbant.','Chauffer la plancha ou une grande poÃªle Ã  feu trÃ¨s vif.','Faire fondre le beurre et faire revenir l\'ail Ã©mincÃ© 30 sec.','Ajouter les crevettes en une couche. Cuire 1 min 30 de chaque cÃ´tÃ©.','DÃ©glacer avec le jus de citron. Ajouter le piment d\'Espelette.','Parsemer de persil hachÃ©. Servir immÃ©diatement avec du pain de campagne.'],tip:'Les crevettes crues passent du translucide Ã  rosÃ©-opaque en 3 min â€” ne surcuisez surtout pas.'},
  'Magret de canard plancha-figues':{temps:'20 min',diff:'Moyen',ing:[['Magret de canard',1,''],['Figues fraÃ®ches',3,''],['Miel',1,'c.s.'],['Vinaigre balsamique',1,'c.s.'],['Thym frais',2,'branches'],['Sel de GuÃ©rande',1,'pincÃ©e'],['Poivre du moulin',1,'pincÃ©e']],steps:['Quadriller la peau du magret au couteau sans atteindre la chair.','Cuire cÃ´tÃ© peau Ã  feu doux 10-12 min pour faire fondre le gras. Vider le gras Ã  mi-cuisson.','Retourner et cuire cÃ´tÃ© chair 4-5 min. Le magret doit Ãªtre rosÃ© Ã  cÅ“ur.','Envelopper dans du papier alu et laisser reposer 5 min.','Pendant ce temps, poÃªler les figues coupÃ©es en deux avec le miel et le balsamique 3 min.','Trancher le magret en biais. Dresser avec les figues et le jus.'],tip:'Le magret se mange rosÃ© â€” surcuit, il devient dur et perd tout son fondant.'},
  'Soupe lentilles-cumin-citron':{temps:'25 min',diff:'Facile',ing:[['Lentilles corail',120,'g'],['Oignon',1,''],['Bouillon de lÃ©gumes',600,'ml'],['Cumin en poudre',1,'c.c.'],['Curcuma',0.5,'c.c.'],['Jus de citron',1,'c.s.'],['Huile d\'olive',1,'c.s.'],['Coriandre fraÃ®che',3,'brins']],steps:['Faire revenir l\'oignon Ã©mincÃ© dans l\'huile avec le cumin et le curcuma 3 min.','Rincer les lentilles corail. Les ajouter avec le bouillon.','Porter Ã  Ã©bullition puis cuire Ã  feu doux 20 min jusqu\'Ã  dissolution des lentilles.','Mixer partiellement pour garder un peu de texture.','Ajouter le jus de citron. Rectifier l\'assaisonnement.','Servir avec la coriandre fraÃ®che et un filet d\'huile d\'olive.'],tip:'Les lentilles corail ne nÃ©cessitent pas de trempage â€” elles cuisent vite et fondent naturellement.'},
  'Bowl quinoa-lÃ©gumes rÃ´tis-pois chiches':{temps:'30 min',diff:'Facile',ing:[['Quinoa',80,'g'],['Pois chiches en boÃ®te',100,'g'],['Courgette',1,''],['Poivron',1,''],['Paprika fumÃ©',1,'c.c.'],['Tahini',1,'c.s.'],['Citron',0.5,''],['Ail',1,'gousse']],steps:['PrÃ©chauffer le four Ã  200Â°C.','Couper les lÃ©gumes en morceaux. MÃ©langer avec huile, paprika, sel, poivre.','Ajouter les pois chiches Ã©gouttÃ©s et sÃ©chÃ©s. Ã‰taler sur une plaque. RÃ´tir 25 min.','Cuire le quinoa selon le paquet (environ 15 min).','PrÃ©parer la sauce tahini : mÃ©langer tahini, jus de citron, ail rÃ¢pÃ© et eau pour fluidifier.','Assembler le bowl : quinoa, lÃ©gumes-pois chiches rÃ´tis, sauce tahini.'],tip:'SÃ©chez bien les pois chiches avant de les rÃ´tir â€” l\'humiditÃ© empÃªche le croustillant.'},
  'Salade nordique saumon-pomme-aneth':{temps:'15 min',diff:'Facile',ing:[['Saumon fumÃ©',80,'g'],['Pomme verte',0.5,''],['Concombre',0.5,''],['Aneth frais',5,'brins'],['CrÃ¨me fraÃ®che Ã©paisse',2,'c.s.'],['Jus de citron',1,'c.s.'],['Roquette',40,'g'],['CÃ¢pres',1,'c.c.']],steps:['Couper le concombre et la pomme en fines lamelles ou en dÃ©s.','MÃ©langer la crÃ¨me fraÃ®che avec le jus de citron et la moitiÃ© de l\'aneth ciselÃ©.','Disposer la roquette dans les assiettes.','Ajouter le concombre, la pomme et les tranches de saumon fumÃ©.','Parsemer de cÃ¢pres et du reste d\'aneth.','Napper de sauce crÃ¨me citronnÃ©e. Poivrer gÃ©nÃ©reusement.'],tip:'L\'aneth et le saumon fumÃ© sont des mariÃ©s parfaits â€” ne lÃ©sinez pas sur l\'aneth frais.'},
  'VeloutÃ© potimarron-lait de coco':{temps:'30 min',diff:'Facile',ing:[['Potimarron',400,'g'],['Lait de coco',200,'ml'],['Bouillon de lÃ©gumes',400,'ml'],['Oignon',1,''],['Gingembre frais',1,'c.c.'],['Noix de muscade',1,'pincÃ©e'],['Huile d\'olive',1,'c.s.'],['Graines de courge',1,'c.s.']],steps:['Couper le potimarron en cubes (ne pas Ã©plucher â€” la peau est comestible).','Faire revenir l\'oignon et le gingembre dans l\'huile 3 min.','Ajouter le potimarron et le bouillon. Cuire 20 min jusqu\'Ã  ce qu\'il soit tendre.','Mixer finement avec le lait de coco jusqu\'Ã  obtenir un veloutÃ© lisse.','Assaisonner avec sel, poivre et une pincÃ©e de muscade.','Servir avec les graines de courge grillÃ©es Ã  sec et un filet de lait de coco.'],tip:'Le potimarron ne se pÃ¨le pas â€” sa peau est fine et apporte des nutriments et de la couleur.'}
};

// â”€â”€ Ã‰TAT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
var activeAllergies = new Set();
var selectedThemes  = new Set();
var currentLunches  = [];
var currentDinners  = [];
var currentCourses  = {};

// â”€â”€ HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function hasAllergen(name){
  if(!activeAllergies.size) return false;
  var lc = name.toLowerCase();
  for(var a of activeAllergies){
    var kw = ALLERGEN_KW[a]||[];
    if(kw.some(function(k){ return lc.indexOf(k.toLowerCase())!==-1; })) return true;
  }
  return false;
}
function shuffle(arr){ return arr.slice().sort(function(){ return Math.random()-.5; }); }
function $(id){ return document.getElementById(id); }
function toast(msg){
  var el=$('toast');
  el.textContent=msg;
  el.classList.add('show');
  clearTimeout(el._t);
  el._t=setTimeout(function(){ el.classList.remove('show'); },3000);
}

// â”€â”€ INIT UI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function initAllergies(){
  var g=$('allergiesGrid');
  ALLERGIES.forEach(function(a){
    var btn=document.createElement('button');
    btn.className='allergy-btn';
    btn.type='button';
    btn.textContent=a.label;
    btn.addEventListener('click',function(){
      if(activeAllergies.has(a.id)){ activeAllergies.delete(a.id); btn.classList.remove('active'); }
      else{ activeAllergies.add(a.id); btn.classList.add('active'); }
    });
    g.appendChild(btn);
  });
}

function initThemes(){
  var g=$('themesGrid');
  THEMES.forEach(function(t){
    var btn=document.createElement('button');
    btn.className='theme-btn';
    btn.type='button';
    btn.innerHTML='<span>'+t.emoji+'</span> '+t.label;
    btn.addEventListener('click',function(){
      if(selectedThemes.has(t.id)){
        selectedThemes.delete(t.id);
        btn.classList.remove('selected');
      } else {
        if(selectedThemes.size>=4){ toast('âš ï¸ Maximum 4 thÃ¨mes'); return; }
        selectedThemes.add(t.id);
        btn.classList.add('selected');
      }
      var c=selectedThemes.size;
      $('selectedCount').innerHTML='<strong>'+c+'</strong> thÃ¨me(s) â€” choisis entre 2 et 4';
      $('btnGenerate').disabled=c<2;
    });
    g.appendChild(btn);
  });
}

// â”€â”€ GÃ‰NÃ‰RATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function pickMeals(themes, slot){
  var result=[];
  themes.forEach(function(tid){
    var db=MEALS[tid];
    if(!db) return;
    var pool=shuffle(slot==='dej'?db.dej:db.din);
    var tag=THEMES.find(function(t){ return t.id===tid; });
    var tagLabel=tag?tag.label:'';
    pool.slice(0,Math.ceil(7/themes.length)).forEach(function(name){
      result.push({name:name,tag:tagLabel});
    });
  });
  return shuffle(result).slice(0,7);
}

function generate(){
  if(selectedThemes.size<2) return;
  $('loading').classList.add('visible');
  $('results').classList.remove('visible');
  setTimeout(function(){
    var themes=Array.from(selectedThemes);
    currentLunches=pickMeals(themes,'dej');
    currentDinners=pickMeals(themes,'din');
    renderWeek(currentLunches,currentDinners);
    var p=parseInt($('nbPersonnes').value)||2;
    currentCourses=buildCourses(currentLunches.concat(currentDinners),p);
    renderCourses(currentCourses);
    $('loading').classList.remove('visible');
    $('results').classList.add('visible');
    $('results').scrollIntoView({behavior:'smooth',block:'start'});
  },700);
}

// â”€â”€ SEMAINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderWeek(lunches,dinners){
  var g=$('daysGrid');
  g.innerHTML='';
  DAYS.forEach(function(day,i){
    var l=lunches[i]||{name:'â€”',tag:''};
    var d=dinners[i]||{name:'â€”',tag:''};
    var card=document.createElement('div');
    card.className='day-card';
    card.innerHTML=
      '<div class="day-name">'+day+'</div>'+
      '<div class="day-meals">'+
        '<div class="meal-item lunch'+(hasAllergen(l.name)?' has-warning':'')+'">'+
          '<div class="meal-label">â˜€ï¸ DÃ©jeuner</div>'+
          '<div class="meal-name">'+l.name+'</div>'+
          (l.tag?'<div class="meal-theme-tag">'+l.tag+'</div>':'')+
        '</div>'+
        '<div class="meal-item dinner'+(hasAllergen(d.name)?' has-warning':'')+'">'+
          '<div class="meal-label">ğŸŒ™ DÃ®ner</div>'+
          '<div class="meal-name">'+d.name+'</div>'+
          (d.tag?'<div class="meal-theme-tag">'+d.tag+'</div>':'')+
        '</div>'+
      '</div>';
    card.querySelector('.meal-item.lunch').addEventListener('click',function(){ openRecipe(l); });
    card.querySelector('.meal-item.dinner').addEventListener('click',function(){ openRecipe(d); });
    g.appendChild(card);
  });
}

// â”€â”€ RECETTE MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openRecipe(meal){
  var rec=RECIPES[meal.name];
  var p=parseInt($('nbPersonnes').value)||2;
  var hw=hasAllergen(meal.name);
  var an=Array.from(activeAllergies).map(function(a){
    var f=ALLERGIES.find(function(x){ return x.id===a; });
    return f?f.label:'';
  }).filter(Boolean);

  $('modalTag').textContent=(meal.tag||'')+' Â· Recette';
  $('modalTitle').textContent=meal.name;

  if(rec){
    $('modalMeta').innerHTML='<span>â±ï¸ '+rec.temps+'</span><span>ğŸ‘¨â€ğŸ³ '+rec.diff+'</span><span>ğŸ½ï¸ '+p+' pers.</span>';
    var ings=rec.ing.map(function(i){
      var q=i[0]; var qty=i[1]; var unit=i[2];
      if(qty===null||qty==='') return {name:q,qty:unit};
      return {name:q,qty:parseFloat((qty*p).toFixed(1))+' '+unit};
    });
    var body='';
    if(hw) body+='<div class="modal-note warning">âš ï¸ Peut contenir : <strong>'+an.join(', ')+'</strong></div>';
    if(p>1) body+='<div class="modal-note">ğŸ‘¥ QuantitÃ©s pour <strong>'+p+' personnes</strong></div>';
    body+='<div class="recipe-section-title">IngrÃ©dients</div>';
    body+='<div class="ingredients-grid">'+ings.map(function(i){
      return '<div class="ingredient-row"><span>'+i.name+'</span><span class="ingredient-qty">'+i.qty+'</span></div>';
    }).join('')+'</div>';
    body+='<div class="recipe-section-title">PrÃ©paration</div>';
    body+='<div class="steps-list">'+rec.steps.map(function(s,idx){
      return '<div class="step"><div class="step-num">'+(idx+1)+'</div><div class="step-text">'+s+'</div></div>';
    }).join('')+'</div>';
    if(rec.tip) body+='<div class="chef-tip"><strong>ğŸ’¡ Astuce du chef</strong>'+rec.tip+'</div>';
    $('modalBody').innerHTML=body;
  } else {
    $('modalMeta').innerHTML='<span>ğŸ½ï¸ '+p+' pers.</span>';
    var body2='';
    if(hw) body2+='<div class="modal-note warning">âš ï¸ Peut contenir : <strong>'+an.join(', ')+'</strong></div>';
    body2+='<div class="modal-note" style="background:#EEF2EC;border-color:#7A8C6E;color:#3D4F33;">ğŸ“– Recette bientÃ´t disponible â€” recherchez "<strong>'+meal.name+'</strong>" en ligne pour la recette complÃ¨te.</div>';
    $('modalBody').innerHTML=body2;
  }

  $('recipeOverlay').classList.add('open');
  document.body.style.overflow='hidden';
}

function closeRecipe(){
  $('recipeOverlay').classList.remove('open');
  document.body.style.overflow='';
}

// â”€â”€ COURSES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildCourses(meals,p){
  var names=meals.map(function(m){ return m.name.toLowerCase(); });
  var has=function(kw){ return names.some(function(n){ return n.indexOf(kw)!==-1; }); };
  var qg=function(g){ return (g*p)+' g'; };
  var c={
    'ğŸ¥© Viandes & Poissons':[],
    'ğŸ¥¦ LÃ©gumes & Fruits':[],
    'ğŸ§€ CrÃ©merie':[],
    'ğŸŒ¾ FÃ©culents & Ã‰picerie':[],
    'ğŸ«™ Conserves & Sauces':[],
    'ğŸŒ¿ Herbes & Ã‰pices':[]
  };
  if(has('poulet')||has('dinde')) c['ğŸ¥© Viandes & Poissons'].push({name:'Poulet / Dinde',qty:qg(300)});
  if(has('bÅ“uf')||has('steak')||has('smash')||has('goulash')||has('bourguignon')) c['ğŸ¥© Viandes & Poissons'].push({name:'BÅ“uf',qty:qg(250)});
  if(has('agneau')||has('navarin')||has('tagine agneau')) c['ğŸ¥© Viandes & Poissons'].push({name:'Agneau',qty:qg(250)});
  if(has('veau')||has('blanquette')||has('escalope')) c['ğŸ¥© Viandes & Poissons'].push({name:'Veau',qty:qg(200)});
  if(has('canard')||has('magret')) c['ğŸ¥© Viandes & Poissons'].push({name:'Magret de canard',qty:(1*p)+' piÃ¨ce(s)'});
  if(has('saumon')) c['ğŸ¥© Viandes & Poissons'].push({name:'Saumon',qty:(1*p)+' pavÃ©(s)'});
  if(has('thon')) c['ğŸ¥© Viandes & Poissons'].push({name:'Thon en boÃ®te',qty:(1*p)+' boÃ®te(s)'});
  if(has('cabillaud')) c['ğŸ¥© Viandes & Poissons'].push({name:'Dos de cabillaud',qty:qg(180)});
  if(has('crevettes')||has('gambas')) c['ğŸ¥© Viandes & Poissons'].push({name:'Crevettes / Gambas',qty:qg(200)});
  if(has('moules')) c['ğŸ¥© Viandes & Poissons'].push({name:'Moules fraÃ®ches',qty:qg(600)});
  if(has('jambon')&&!has('jambon cru')) c['ğŸ¥© Viandes & Poissons'].push({name:'Jambon blanc',qty:qg(100)});
  if(has('jambon cru')) c['ğŸ¥© Viandes & Poissons'].push({name:'Jambon cru',qty:'6 tranches'});
  if(has('lardons')) c['ğŸ¥© Viandes & Poissons'].push({name:'Lardons fumÃ©s',qty:qg(150)});
  if(has('saucisse')||has('chorizo')) c['ğŸ¥© Viandes & Poissons'].push({name:'Saucisse / Chorizo',qty:qg(200)});
  if(has('sardine')) c['ğŸ¥© Viandes & Poissons'].push({name:'Sardines',qty:(2*p)+' boÃ®te(s)'});
  if(has('saumon fumÃ©')) c['ğŸ¥© Viandes & Poissons'].push({name:'Saumon fumÃ©',qty:(p*80)+' g'});

  if(has('tomat')) c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Tomates',qty:qg(400)});
  if(has('courgette')) c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Courgettes',qty:(2*p)+' piÃ¨ces'});
  if(has('poivron')) c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Poivrons',qty:(2*p)+' piÃ¨ces'});
  if(has('champignon')) c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Champignons de Paris',qty:qg(250)});
  if(has('Ã©pinard')) c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Ã‰pinards frais',qty:qg(200)});
  if(has('avocat')) c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Avocats',qty:(p)+' piÃ¨ce(s)'});
  if(has('pomme de terre')||has('frites')||has('gratin')||has('dauphinois')||has('pot-au-feu')) c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Pommes de terre',qty:qg(600)});
  if(has('patate douce')) c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Patates douces',qty:qg(300)});
  if(has('carotte')) c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Carottes',qty:(4*p)+' piÃ¨ces'});
  if(has('poireau')) c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Poireaux',qty:(2*p)+' piÃ¨ces'});
  if(has('aubergine')) c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Aubergines',qty:(1*p)+' piÃ¨ce(s)'});
  if(has('potimarron')||has('courge')) c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Potimarron / Courge',qty:qg(500)});
  if(has('figue')) c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Figues fraÃ®ches',qty:(3*p)+' piÃ¨ces'});
  if(has('betterave')) c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Betteraves',qty:(2*p)+' piÃ¨ces'});
  c['ğŸ¥¦ LÃ©gumes & Fruits'].push({name:'Oignons',qty:'1 filet'},{name:'Ail',qty:'2 tÃªtes'},{name:'Citrons',qty:(3*p)+' piÃ¨ces'});

  c['ğŸ§€ CrÃ©merie'].push({name:'Å’ufs',qty:(8*p)+' piÃ¨ces'},{name:'Beurre',qty:'250 g'},{name:'CrÃ¨me fraÃ®che',qty:(p<=2?'40':'80')+' cl'});
  if(has('parmesan')) c['ğŸ§€ CrÃ©merie'].push({name:'Parmesan',qty:qg(80)});
  if(has('mozzarella')||has('burrata')) c['ğŸ§€ CrÃ©merie'].push({name:'Mozzarella / Burrata',qty:(p)+' boule(s)'});
  if(has('feta')) c['ğŸ§€ CrÃ©merie'].push({name:'Feta',qty:qg(200)});
  if(has('chÃ¨vre')) c['ğŸ§€ CrÃ©merie'].push({name:'BÃ»che de chÃ¨vre',qty:'1 bÃ»che'});
  if(has('comtÃ©')||has('gruyÃ¨re')||has('cheddar')||has('crozet')||has('raclette')) c['ğŸ§€ CrÃ©merie'].push({name:'Fromage Ã  gratiner',qty:qg(200)});
  if(has('halloumi')) c['ğŸ§€ CrÃ©merie'].push({name:'Halloumi',qty:qg(250)});
  if(has('ricotta')) c['ğŸ§€ CrÃ©merie'].push({name:'Ricotta',qty:'250 g'});
  if(has('reblochon')||has('tartiflette')) c['ğŸ§€ CrÃ©merie'].push({name:'Reblochon',qty:'1 fromage'});

  if(has('riz')) c['ğŸŒ¾ FÃ©culents & Ã‰picerie'].push({name:'Riz',qty:qg(100)+'/repas'});
  if(has('quinoa')) c['ğŸŒ¾ FÃ©culents & Ã‰picerie'].push({name:'Quinoa',qty:qg(100)});
  if(has('pÃ¢tes')||has('spaghetti')||has('penne')||has('linguine')||has('tagliatelle')) c['ğŸŒ¾ FÃ©culents & Ã‰picerie'].push({name:'PÃ¢tes',qty:qg(100)+'/repas'});
  if(has('lentilles')) c['ğŸŒ¾ FÃ©culents & Ã‰picerie'].push({name:'Lentilles (vertes ou corail)',qty:qg(150)});
  if(has('ramen')||has('soba')||has('nouilles')||has('pad thaÃ¯')||has('pho')) c['ğŸŒ¾ FÃ©culents & Ã‰picerie'].push({name:'Nouilles asiatiques',qty:qg(80)});
  if(has('naan')||has('pita')||has('chapati')) c['ğŸŒ¾ FÃ©culents & Ã‰picerie'].push({name:'Naan / Pita',qty:'1 paquet'});
  if(has('boulgour')||has('tabulÃ©')) c['ğŸŒ¾ FÃ©culents & Ã‰picerie'].push({name:'Boulgour',qty:qg(100)});
  if(has('semoule')||has('tagine')) c['ğŸŒ¾ FÃ©culents & Ã‰picerie'].push({name:'Semoule',qty:qg(100)});
  if(has('pizza')||has('burger')||has('hot-dog')||has('kebab')) c['ğŸŒ¾ FÃ©culents & Ã‰picerie'].push({name:'Pains / Buns / Tortillas',qty:'1 paquet'});
  c['ğŸŒ¾ FÃ©culents & Ã‰picerie'].push({name:'Pain de campagne',qty:'1 miche'});

  if(has('tomat')) c['ğŸ«™ Conserves & Sauces'].push({name:'Tomates pelÃ©es / concassÃ©es',qty:(2*p)+' boÃ®tes'});
  if(has('pois chiches')||has('houmous')||has('falafel')) c['ğŸ«™ Conserves & Sauces'].push({name:'Pois chiches en boÃ®te',qty:(2*p)+' boÃ®tes'});
  if(has('haricots')) c['ğŸ«™ Conserves & Sauces'].push({name:'Haricots blancs / rouges',qty:(1*p)+' boÃ®te(s)'});
  if(has('lait de coco')||has('coco')||has('curry')||has('thaÃ¯')) c['ğŸ«™ Conserves & Sauces'].push({name:'Lait de coco',qty:(2*p)+' boÃ®tes'});
  if(has('miso')) c['ğŸ«™ Conserves & Sauces'].push({name:'PÃ¢te miso',qty:'1 pot'});
  if(has('soja')||has('wok')||has('teriyaki')||has('pad thaÃ¯')) c['ğŸ«™ Conserves & Sauces'].push({name:'Sauce soja',qty:'1 bouteille'});
  if(has('anchois')) c['ğŸ«™ Conserves & Sauces'].push({name:'Anchois en boÃ®te',qty:'1 boÃ®te'});
  if(has('harissa')) c['ğŸ«™ Conserves & Sauces'].push({name:'Harissa',qty:'1 tube'});
  if(has('tahini')||has('houmous')) c['ğŸ«™ Conserves & Sauces'].push({name:'Tahini (purÃ©e de sÃ©same)',qty:'1 pot'});
  c['ğŸ«™ Conserves & Sauces'].push({name:'Huile d\'olive',qty:'1 bouteille'},{name:'Bouillon (lÃ©gumes & bÅ“uf)',qty:'1 boÃ®te chaque'},{name:'Moutarde de Dijon',qty:'1 pot'},{name:'Vinaigre de vin rouge & blanc',qty:'1 bouteille chaque'});

  c['ğŸŒ¿ Herbes & Ã‰pices'].push({name:'Persil plat frais',qty:'2 bouquets'},{name:'Thym, laurier, romarin',qty:'1 bouquet garni'});
  if(has('basilic')) c['ğŸŒ¿ Herbes & Ã‰pices'].push({name:'Basilic frais',qty:'1 pot'});
  if(has('coriandre')) c['ğŸŒ¿ Herbes & Ã‰pices'].push({name:'Coriandre fraÃ®che',qty:'1 bouquet'});
  if(has('aneth')) c['ğŸŒ¿ Herbes & Ã‰pices'].push({name:'Aneth frais',qty:'1 bouquet'});
  if(has('gingembre')) c['ğŸŒ¿ Herbes & Ã‰pices'].push({name:'Gingembre frais',qty:'1 morceau'});
  if(has('curry')||has('dhal')||has('mafÃ©')||has('garam')) c['ğŸŒ¿ Herbes & Ã‰pices'].push({name:'Curry / Garam masala / Curcuma',qty:'1 pot chaque'});
  if(has('cumin')) c['ğŸŒ¿ Herbes & Ã‰pices'].push({name:'Cumin en poudre',qty:'1 pot'});
  if(has('paprika')||has('espelette')) c['ğŸŒ¿ Herbes & Ã‰pices'].push({name:'Paprika / Piment d\'Espelette',qty:'1 pot chaque'});
  c['ğŸŒ¿ Herbes & Ã‰pices'].push({name:'Fleur de sel & poivre du moulin',qty:'selon besoin'});

  return c;
}

function renderCourses(courses){
  var g=$('coursesGrid');
  g.innerHTML='';
  Object.keys(courses).forEach(function(cat){
    var items=courses[cat];
    if(!items.length) return;
    var div=document.createElement('div');
    div.className='course-category';
    div.innerHTML='<div class="cat-title">'+cat+'</div>'+
      items.map(function(i){
        return '<div class="course-item"><span class="course-name">'+i.name+'</span><span class="course-qty">'+i.qty+'</span></div>';
      }).join('');
    g.appendChild(div);
  });
}

// â”€â”€ PARTAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildShareText(){
  var p=$('nbPersonnes').value;
  var t='ğŸ½ï¸ KESKONMANJ â€” Ma semaine ('+p+' pers.)\n\n';
  DAYS.forEach(function(d,i){
    t+=d+' : '+(currentLunches[i]?currentLunches[i].name:'â€”')+' / '+(currentDinners[i]?currentDinners[i].name:'â€”')+'\n';
  });
  t+='\nğŸ›’ LISTE DE COURSES\n';
  Object.keys(currentCourses).forEach(function(cat){
    var items=currentCourses[cat];
    if(!items.length) return;
    t+='\n'+cat+'\n';
    items.forEach(function(i){ t+='â˜ '+i.name+' â€” '+i.qty+'\n'; });
  });
  t+='\nâ€” GÃ©nÃ©rÃ© avec Keskonmanj by fluide.cmpny';
  return t;
}

function openShare(){
  if(!currentLunches.length){ toast('âš ï¸ GÃ©nÃ¨re d\'abord une semaine !'); return; }
  var txt=buildShareText();
  $('shareCopyInput').value=txt.substring(0,80)+'â€¦';
  $('shareOverlay').classList.add('open');
  document.body.style.overflow='hidden';
}

function closeShare(){
  $('shareOverlay').classList.remove('open');
  document.body.style.overflow='';
}

function doShare(ch){
  var txt=buildShareText();
  var enc=encodeURIComponent(txt);
  closeShare();
  if(ch==='whatsapp') window.open('https://api.whatsapp.com/send?text='+enc,'_blank');
  else if(ch==='sms') window.open('sms:?body='+enc,'_blank');
  else if(ch==='email') window.open('mailto:?subject='+encodeURIComponent('ğŸ½ï¸ Ma semaine Keskonmanj')+'&body='+enc,'_blank');
  else if(ch==='telegram') window.open('https://t.me/share/url?url=https://fluide.cmpny&text='+enc,'_blank');
  else if(ch==='native'){
    if(navigator.share){ navigator.share({title:'Keskonmanj',text:txt}).catch(function(){}); }
    else{ copyText(txt); }
  }
  else if(ch==='print') window.print();
}

function copyText(txt){
  if(navigator.clipboard&&navigator.clipboard.writeText){
    navigator.clipboard.writeText(txt).then(function(){ toast('ğŸ“‹ CopiÃ© !'); }).catch(function(){ legacyCopy(txt); });
  } else { legacyCopy(txt); }
}

function legacyCopy(txt){
  var ta=document.createElement('textarea');
  ta.value=txt;
  ta.style.cssText='position:fixed;opacity:0;top:0;left:0;';
  document.body.appendChild(ta);
  ta.focus();
  ta.select();
  try{ document.execCommand('copy'); toast('ğŸ“‹ CopiÃ© !'); }
  catch(e){ toast('SÃ©lectionne le texte manuellement'); }
  document.body.removeChild(ta);
}

// â”€â”€ SAUVEGARDE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function saveWeek(){
  if(!currentLunches.length){ toast('âš ï¸ Rien Ã  sauvegarder'); return; }
  var data={
    savedAt:new Date().toLocaleDateString('fr-FR',{weekday:'long',day:'numeric',month:'long'}),
    lunches:currentLunches,dinners:currentDinners,
    themes:Array.from(selectedThemes),
    persons:$('nbPersonnes').value,
    allergies:Array.from(activeAllergies)
  };
  Store.set('keskonmanj',JSON.stringify(data));
  $('saveBadge').classList.add('visible');
  $('savedBanner').classList.add('visible');
  toast('âœ… Semaine sauvegardÃ©e !');
}

function restoreWeek(){
  var raw=Store.get('keskonmanj');
  if(!raw){ toast('Aucune sauvegarde trouvÃ©e'); return; }
  var data;
  try{ data=JSON.parse(raw); }catch(e){ toast('Erreur de lecture'); return; }
  currentLunches=data.lunches||[];
  currentDinners=data.dinners||[];
  selectedThemes=new Set(data.themes||[]);
  document.querySelectorAll('.theme-btn').forEach(function(btn,i){
    btn.classList.toggle('selected',selectedThemes.has(THEMES[i]&&THEMES[i].id));
  });
  if(data.persons) $('nbPersonnes').value=data.persons;
  if(data.allergies){
    activeAllergies=new Set(data.allergies);
    document.querySelectorAll('.allergy-btn').forEach(function(btn,i){
      btn.classList.toggle('active',activeAllergies.has(ALLERGIES[i]&&ALLERGIES[i].id));
    });
  }
  var c=selectedThemes.size;
  $('selectedCount').innerHTML='<strong>'+c+'</strong> thÃ¨me(s) â€” choisis entre 2 et 4';
  $('btnGenerate').disabled=c<2;
  renderWeek(currentLunches,currentDinners);
  currentCourses=buildCourses(currentLunches.concat(currentDinners),data.persons||2);
  renderCourses(currentCourses);
  $('saveBadge').classList.add('visible');
  $('results').classList.add('visible');
  $('results').scrollIntoView({behavior:'smooth',block:'start'});
  toast('ğŸ”„ Semaine restaurÃ©e !');
}

function clearSave(){
  if(!confirm('Effacer la sauvegarde et rÃ©initialiser ?')) return;
  Store.del('keskonmanj');
  $('saveBadge').classList.remove('visible');
  $('savedBanner').classList.remove('visible');
  $('results').classList.remove('visible');
  currentLunches=[];currentDinners=[];currentCourses={};
  toast('ğŸ—‘ï¸ EffacÃ©');
}

// â”€â”€ EVENTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
$('btnGenerate').addEventListener('click',generate);
$('btnSave').addEventListener('click',saveWeek);
$('btnShare').addEventListener('click',openShare);
$('btnPrint').addEventListener('click',function(){ window.print(); });
$('btnClear').addEventListener('click',clearSave);
$('btnRestore').addEventListener('click',restoreWeek);
$('btnCloseRecipe').addEventListener('click',closeRecipe);
$('recipeOverlay').addEventListener('click',function(e){ if(e.target===$('recipeOverlay')) closeRecipe(); });
$('btnCloseShare').addEventListener('click',closeShare);
$('shareOverlay').addEventListener('click',function(e){ if(e.target===$('shareOverlay')) closeShare(); });
$('sWhatsapp').addEventListener('click',function(){ doShare('whatsapp'); });
$('sSms').addEventListener('click',function(){ doShare('sms'); });
$('sEmail').addEventListener('click',function(){ doShare('email'); });
$('sTelegram').addEventListener('click',function(){ doShare('telegram'); });
$('sNative').addEventListener('click',function(){ doShare('native'); });
$('sPrint').addEventListener('click',function(){ doShare('print'); });
$('sCopy').addEventListener('click',function(){ copyText(buildShareText()); });
document.addEventListener('keydown',function(e){ if(e.key==='Escape'){ closeRecipe(); closeShare(); } });

// Check sauvegarde au lancement
if(Store.get('keskonmanj')) $('savedBanner').classList.add('visible');

// Init
initAllergies();
initThemes();
</script>
</body>
</html>
